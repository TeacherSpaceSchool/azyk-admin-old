{"ast":null,"code":"import _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _Array$isArray from \"@babel/runtime-corejs2/core-js/array/is-array\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nvar _jsxFileName = \"C:\\\\projects\\\\azyk\\\\azyk-admin\\\\pages\\\\basket.js\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport React, { useState, useEffect } from 'react';\nimport App from '../layouts/App';\nimport { connect } from 'react-redux';\nimport pageListStyle from '../src/styleMUI/basket/basket';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport { bindActionCreators } from 'redux';\nimport * as mini_dialogActions from '../redux/actions/mini_dialog';\nimport * as snackbarActions from '../redux/actions/snackbar';\nimport { getBasket, setBasket, deleteBasket } from '../src/gql/basket';\nimport { getClient } from '../src/gql/client';\nimport Router from 'next/router';\nimport BuyBasket from '../components/dialog/BuyBasket';\nimport Sign from '../components/dialog/Sign';\nimport Confirmation from '../components/dialog/Confirmation';\nimport { urlMain } from '../redux/constants/other';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport { getBonusesClient } from '../src/gql/bonusclient';\nimport TextField from '@material-ui/core/TextField';\nimport { getClients } from '../src/gql/client';\nvar Basket = React.memo(function (props) {\n  var _props$user = props.user,\n      authenticated = _props$user.authenticated,\n      profile = _props$user.profile;\n  var classes = pageListStyle();\n  var _props$mini_dialogAct = props.mini_dialogActions,\n      setMiniDialog = _props$mini_dialogAct.setMiniDialog,\n      showMiniDialog = _props$mini_dialogAct.showMiniDialog;\n  var showSnackBar = props.snackbarActions.showSnackBar;\n  var data = props.data;\n  console.log(data);\n\n  var _useState = useState(data.baskets),\n      list = _useState[0],\n      setList = _useState[1];\n\n  var _useState2 = useState({}),\n      bonus = _useState2[0],\n      setBonus = _useState2[1];\n\n  var _useState3 = useState({\n    _id: '',\n    name: ''\n  }),\n      organization = _useState3[0],\n      setOrganization = _useState3[1];\n\n  var handleOrganization = function handleOrganization(event) {\n    setOrganization(organizations[organizations.findIndex(function (element) {\n      return element._id === event.target.value;\n    })]);\n  };\n\n  var _useState4 = useState([]),\n      organizations = _useState4[0],\n      setOrganizations = _useState4[1];\n\n  var _useState5 = useState({\n    _id: '',\n    name: ''\n  }),\n      client = _useState5[0],\n      setClient = _useState5[1];\n\n  var handleClient = function handleClient(event) {\n    setClient(clients[clients.findIndex(function (element) {\n      return element._id === event.target.value;\n    })]);\n  };\n\n  var _useState6 = useState([]),\n      clients = _useState6[0],\n      setClients = _useState6[1];\n\n  var _useState7 = useState(0),\n      allPrice = _useState7[0],\n      setAllPrice = _useState7[1];\n\n  var isMobileApp = props.app.isMobileApp;\n\n  var increment = function increment(idx) {\n    list[idx].count += 1;\n    setBasketChange(idx, list[idx].count);\n    setList(_toConsumableArray(list));\n  };\n\n  var decrement = function decrement(idx) {\n    if (list[idx].count > 1) {\n      list[idx].count -= 1;\n      setBasketChange(idx, list[idx].count);\n      setList(_toConsumableArray(list));\n    }\n  };\n\n  var setBasketChange = function setBasketChange(idx, count) {\n    if (authenticated) setBasket({\n      _id: list[idx]._id,\n      count: count\n    });else {\n      var _list = JSON.parse(localStorage.basket);\n\n      _list[idx].count = count;\n      localStorage.basket = _JSON$stringify(_list);\n    }\n  };\n\n  var removeBasketChange =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(idx) {\n      var action;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              action =\n              /*#__PURE__*/\n              function () {\n                var _ref2 = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee() {\n                  var _list2;\n\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          if (!authenticated) {\n                            _context.next = 8;\n                            break;\n                          }\n\n                          _context.t0 = setList;\n                          _context.next = 4;\n                          return deleteBasket([list[idx]._id]);\n\n                        case 4:\n                          _context.t1 = _context.sent.baskets;\n                          (0, _context.t0)(_context.t1);\n                          _context.next = 12;\n                          break;\n\n                        case 8:\n                          _list2 = JSON.parse(localStorage.basket);\n\n                          _list2.splice(idx, 1);\n\n                          localStorage.basket = _JSON$stringify(_list2);\n                          setList(_list2);\n\n                        case 12:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function action() {\n                  return _ref2.apply(this, arguments);\n                };\n              }();\n\n              setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n                action: action,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 86\n                },\n                __self: this\n              }));\n              showMiniDialog(true);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function removeBasketChange(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (authenticated) {\n                _context3.next = 5;\n                break;\n              }\n\n              if (localStorage.basket == undefined) {\n                localStorage.basket = _JSON$stringify([]);\n              }\n\n              setList(JSON.parse(localStorage.basket));\n              _context3.next = 11;\n              break;\n\n            case 5:\n              if (!(profile.role === 'агент')) {\n                _context3.next = 11;\n                break;\n              }\n\n              _context3.t0 = setClients;\n              _context3.next = 9;\n              return getClients({\n                search: '',\n                sort: '-name',\n                filter: ''\n              });\n\n            case 9:\n              _context3.t1 = _context3.sent.clients;\n              (0, _context3.t0)(_context3.t1);\n\n            case 11:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  }, []);\n  useEffect(function () {\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      var _loop, i;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              organizations = [];\n\n              _loop = function _loop(i) {\n                if (organizations.findIndex(function (element) {\n                  return element._id === list[i].item.organization._id;\n                }) === -1) {\n                  organizations.push(list[i].item.organization);\n                }\n              };\n\n              for (i = 0; i < list.length; i++) {\n                _loop(i);\n              }\n\n              setOrganizations(_toConsumableArray(organizations));\n              if (organizations.length > 0) setOrganization(_objectSpread({}, organizations[0]));\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n  }, [list]);\n  useEffect(function () {\n    calculateAllPrice();\n    bonus = {};\n\n    for (var i = 0; i < data.bonusesClient.length; i++) {\n      if (organization._id === data.bonusesClient[i].bonus.organization._id) {\n        bonus = data.bonusesClient[i];\n      }\n    }\n\n    setBonus(bonus);\n  }, [list, organization]);\n\n  var getList =\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5() {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.t0 = setList;\n              _context5.next = 3;\n              return getBasket();\n\n            case 3:\n              _context5.t1 = _context5.sent.baskets;\n              (0, _context5.t0)(_context5.t1);\n\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function getList() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var calculateAllPrice =\n  /*#__PURE__*/\n  function () {\n    var _ref6 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee6() {\n      var allPrice, i;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              allPrice = 0;\n\n              for (i = 0; i < list.length; i++) {\n                if (list[i].item.organization._id === organization._id) allPrice += (list[i].item.stock === 0 || list[i].item.stock === undefined ? list[i].item.price : list[i].item.stock) * list[i].count;\n              }\n\n              setAllPrice(allPrice);\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function calculateAllPrice() {\n      return _ref6.apply(this, arguments);\n    };\n  }(); //привести к геолокации\n\n\n  if (data.client && !_Array$isArray(data.client.address[0])) data.client.address.map(function (addres) {\n    return [addres];\n  });\n  return __jsx(App, {\n    getList: getList,\n    pageName: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, __jsx(Head, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, __jsx(\"title\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"), __jsx(\"meta\", {\n    name: \"description\",\n    content: \"\\u0410\\u0437\\u044B\\u043A \\u2013 \\u044D\\u0442\\u043E \\u043E\\u043D\\u043B\\u0430\\u0439\\u043D \\u043F\\u043B\\u0430\\u0442\\u0444\\u043E\\u0440\\u043C\\u0430 \\u0434\\u043B\\u044F \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432 \\u043E\\u043F\\u0442\\u043E\\u043C, \\u0440\\u0430\\u0437\\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u043D\\u043D\\u0430\\u044F \\u0441\\u043F\\u0435\\u0446\\u0438\\u0430\\u043B\\u044C\\u043D\\u043E \\u0434\\u043B\\u044F \\u043C\\u0430\\u043B\\u043E\\u0433\\u043E \\u0438 \\u0441\\u0440\\u0435\\u0434\\u043D\\u0435\\u0433\\u043E \\u0431\\u0438\\u0437\\u043D\\u0435\\u0441\\u0430.  \\u041E\\u043D\\u0430 \\u043E\\u0431\\u044A\\u0435\\u0434\\u0438\\u043D\\u044F\\u0435\\u0442 \\u043F\\u0440\\u043E\\u0438\\u0437\\u0432\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u0435\\u0439 \\u0438 \\u0442\\u043E\\u0440\\u0433\\u043E\\u0432\\u044B\\u0435 \\u0442\\u043E\\u0447\\u043A\\u0438 \\u043D\\u0430\\u043F\\u0440\\u044F\\u043C\\u0443\\u044E, \\u0441\\u043E\\u043A\\u0440\\u0430\\u0449\\u0430\\u044F \\u0440\\u0430\\u0441\\u0445\\u043E\\u0434\\u044B \\u0438 \\u043F\\u043E\\u0432\\u044B\\u0448\\u0430\\u044F \\u043F\\u0440\\u043E\\u0434\\u0430\\u0436\\u0438. \\u0410\\u0437\\u044B\\u043A \\u043F\\u0440\\u0435\\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043B\\u044F\\u0435\\u0442 \\u0441\\u0432\\u043E\\u0438\\u043C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\\u043C \\u043C\\u043E\\u0449\\u043D\\u044B\\u0435 \\u0442\\u0435\\u0445\\u043D\\u043E\\u043B\\u043E\\u0433\\u0438\\u0438 \\u0434\\u043B\\u044F \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F \\u0438 \\u0440\\u0430\\u0437\\u0432\\u0438\\u0442\\u0438\\u044F \\u0441\\u0432\\u043E\\u0435\\u0433\\u043E \\u0431\\u0438\\u0437\\u043D\\u0435\\u0441\\u0430.\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:title\",\n    content: \"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:description\",\n    content: \"\\u0410\\u0437\\u044B\\u043A \\u2013 \\u044D\\u0442\\u043E \\u043E\\u043D\\u043B\\u0430\\u0439\\u043D \\u043F\\u043B\\u0430\\u0442\\u0444\\u043E\\u0440\\u043C\\u0430 \\u0434\\u043B\\u044F \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432 \\u043E\\u043F\\u0442\\u043E\\u043C, \\u0440\\u0430\\u0437\\u0440\\u0430\\u0431\\u043E\\u0442\\u0430\\u043D\\u043D\\u0430\\u044F \\u0441\\u043F\\u0435\\u0446\\u0438\\u0430\\u043B\\u044C\\u043D\\u043E \\u0434\\u043B\\u044F \\u043C\\u0430\\u043B\\u043E\\u0433\\u043E \\u0438 \\u0441\\u0440\\u0435\\u0434\\u043D\\u0435\\u0433\\u043E \\u0431\\u0438\\u0437\\u043D\\u0435\\u0441\\u0430.  \\u041E\\u043D\\u0430 \\u043E\\u0431\\u044A\\u0435\\u0434\\u0438\\u043D\\u044F\\u0435\\u0442 \\u043F\\u0440\\u043E\\u0438\\u0437\\u0432\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u0435\\u0439 \\u0438 \\u0442\\u043E\\u0440\\u0433\\u043E\\u0432\\u044B\\u0435 \\u0442\\u043E\\u0447\\u043A\\u0438 \\u043D\\u0430\\u043F\\u0440\\u044F\\u043C\\u0443\\u044E, \\u0441\\u043E\\u043A\\u0440\\u0430\\u0449\\u0430\\u044F \\u0440\\u0430\\u0441\\u0445\\u043E\\u0434\\u044B \\u0438 \\u043F\\u043E\\u0432\\u044B\\u0448\\u0430\\u044F \\u043F\\u0440\\u043E\\u0434\\u0430\\u0436\\u0438. \\u0410\\u0437\\u044B\\u043A \\u043F\\u0440\\u0435\\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043B\\u044F\\u0435\\u0442 \\u0441\\u0432\\u043E\\u0438\\u043C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\\u043C \\u043C\\u043E\\u0449\\u043D\\u044B\\u0435 \\u0442\\u0435\\u0445\\u043D\\u043E\\u043B\\u043E\\u0433\\u0438\\u0438 \\u0434\\u043B\\u044F \\u043C\\u0430\\u0441\\u0448\\u0442\\u0430\\u0431\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F \\u0438 \\u0440\\u0430\\u0437\\u0432\\u0438\\u0442\\u0438\\u044F \\u0441\\u0432\\u043E\\u0435\\u0433\\u043E \\u0431\\u0438\\u0437\\u043D\\u0435\\u0441\\u0430.\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:type\",\n    content: \"website\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:image\",\n    content: \"\".concat(urlMain, \"/static/512x512.png\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:url\",\n    content: \"\".concat(urlMain, \"/basket\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }), __jsx(\"link\", {\n    rel: \"canonical\",\n    href: \"\".concat(urlMain, \"/basket\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  })), isMobileApp ? __jsx(\"div\", {\n    className: classes.column,\n    style: {\n      width: 'calc(100% - 16px)',\n      margin: 8\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, __jsx(Card, {\n    className: classes.page,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, __jsx(CardContent, {\n    className: classes.column,\n    style: isMobileApp ? {} : {\n      justifyContent: 'start',\n      alignItems: 'flex-start'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, profile.role === 'агент' ? __jsx(TextField, {\n    select: true,\n    label: \"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\",\n    value: client._id,\n    onChange: handleClient,\n    helperText: \"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\",\n    className: classes.input,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, clients.map(function (element) {\n    return __jsx(MenuItem, {\n      key: element._id,\n      value: element._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, element.name);\n  })) : __jsx(TextField, {\n    select: true,\n    label: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\",\n    value: organization._id,\n    onChange: handleOrganization,\n    helperText: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\",\n    className: classes.input,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, organizations.map(function (element) {\n    return __jsx(MenuItem, {\n      key: element._id,\n      value: element._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, element.name);\n  })))), list.map(function (row, idx) {\n    if (row.item.organization._id === organization._id) return __jsx(Card, {\n      className: classes.page,\n      key: idx,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, __jsx(CardContent, {\n      className: classes.column,\n      style: isMobileApp ? {} : {\n        justifyContent: 'start',\n        alignItems: 'flex-start'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.itemM,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.divImage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, __jsx(\"img\", {\n      className: classes.mediaM,\n      src: row.item.image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }), __jsx(IconButton, {\n      onClick: function onClick() {\n        removeBasketChange(idx);\n      },\n      color: \"primary\",\n      className: classes.cancelM,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, __jsx(CancelIcon, {\n      style: {\n        height: 40,\n        width: 40\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }))), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: classes.nameM,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, row.item.name), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: classes.counter,\n      style: isMobileApp ? {\n        marginBottom: 20\n      } : {\n        marginRight: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.counterbtn,\n      onClick: function onClick() {\n        decrement(idx);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \"\\u2013\"), __jsx(\"input\", {\n      type: \"text\",\n      className: classes.counternmbr,\n      value: row.count,\n      onChange: function onChange(event) {\n        list[idx].count = isNaN(event.target.value) || event.target.value.length === 0 ? 0 : _parseInt(event.target.value);\n        setBasketChange(idx, list[idx].count);\n        setList(_toConsumableArray(list));\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: classes.counterbtn,\n      onClick: function onClick() {\n        increment(idx);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, \"+\")), __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, \"\\u0426\\u0435\\u043D\\u0430\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }, \"\".concat(row.item.stock === 0 || row.item.stock === undefined ? row.item.price : row.item.stock, \" \\u0441\\u043E\\u043C\"))), __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }, \"\\u0418\\u0442\\u043E\\u0433\\u043E\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }, \"\".concat((row.item.stock === 0 || row.item.stock === undefined ? row.item.price : row.item.stock) * row.count, \" \\u0441\\u043E\\u043C\")))))));\n  }), __jsx(\"div\", {\n    style: {\n      height: 70\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  })) : __jsx(React.Fragment, null, __jsx(Card, {\n    className: classes.page,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256\n    },\n    __self: this\n  }, __jsx(CardContent, {\n    className: classes.column,\n    style: isMobileApp ? {} : {\n      justifyContent: 'start',\n      alignItems: 'flex-start'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257\n    },\n    __self: this\n  }, __jsx(Table, {\n    \"aria-label\": \"simple table\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258\n    },\n    __self: this\n  }, __jsx(TableHead, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259\n    },\n    __self: this\n  }, __jsx(TableRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260\n    },\n    __self: this\n  }, __jsx(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261\n    },\n    __self: this\n  }, profile.role === 'агент' ? __jsx(FormControl, {\n    className: classes.input,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264\n    },\n    __self: this\n  }, __jsx(InputLabel, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265\n    },\n    __self: this\n  }, \"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\"), __jsx(Select, {\n    value: client._id,\n    onChange: handleClient,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266\n    },\n    __self: this\n  }, clients.map(function (element) {\n    return __jsx(MenuItem, {\n      key: element._id,\n      value: element._id,\n      ola: element.name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, element.name);\n  }))) : __jsx(FormControl, {\n    className: classes.input,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273\n    },\n    __self: this\n  }, __jsx(InputLabel, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274\n    },\n    __self: this\n  }, \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\"), __jsx(Select, {\n    value: organization._id,\n    onChange: handleOrganization,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275\n    },\n    __self: this\n  }, organizations.map(function (element) {\n    return __jsx(MenuItem, {\n      key: element._id,\n      value: element._id,\n      ola: element.name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, element.name);\n  })))), __jsx(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283\n    },\n    __self: this\n  }, \"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"), __jsx(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284\n    },\n    __self: this\n  }, \"\\u0426\\u0435\\u043D\\u0430\"), __jsx(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285\n    },\n    __self: this\n  }, \"\\u0418\\u0442\\u043E\\u0433\\u043E\"), __jsx(TableCell, {\n    align: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286\n    },\n    __self: this\n  }, \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"))), __jsx(TableBody, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289\n    },\n    __self: this\n  }, list.map(function (row, idx) {\n    if (row.item.organization._id === organization._id) return __jsx(TableRow, {\n      key: idx,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, __jsx(\"img\", {\n      className: classes.mediaD,\n      src: row.item.image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: classes.nameD,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, row.item.name))), __jsx(TableCell, {\n      align: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.counterD,\n      style: isMobileApp ? {\n        marginBottom: 20\n      } : {\n        marginRight: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.counterbtnD,\n      onClick: function onClick() {\n        decrement(idx);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, \"\\u2013\"), __jsx(\"input\", {\n      type: \"text\",\n      className: classes.counternmbrD,\n      value: row.count,\n      onChange: function onChange(event) {\n        list[idx].count = isNaN(event.target.value) || event.target.value.length === 0 ? 0 : _parseInt(event.target.value);\n        setBasketChange(idx, list[idx].count);\n        setList(_toConsumableArray(list));\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: classes.counterbtnD,\n      onClick: function onClick() {\n        increment(idx);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, \"+\"))), __jsx(TableCell, {\n      align: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, \"\".concat(row.item.stock === 0 || row.item.stock === undefined ? row.item.price : row.item.stock * row.count, \" \\u0441\\u043E\\u043C\")), __jsx(TableCell, {\n      align: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, \"\".concat((row.item.stock === 0 || row.item.stock === undefined ? row.item.price : row.item.stock * row.count) * row.count, \" \\u0441\\u043E\\u043C\")), __jsx(TableCell, {\n      align: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }, __jsx(IconButton, {\n      onClick: function onClick() {\n        removeBasketChange(idx);\n      },\n      color: \"primary\",\n      className: classes.button,\n      \"aria-label\": \"add to shopping cart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, __jsx(CancelIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }))));\n  }))))), __jsx(\"div\", {\n    style: {\n      height: 70\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    className: isMobileApp ? classes.bottomBasketM : classes.bottomBasketD,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: isMobileApp ? classes.allPriceM : classes.allPriceD,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: isMobileApp ? classes.value : classes.priceAllText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334\n    },\n    __self: this\n  }, \"\\u041E\\u0431\\u0449\\u0430\\u044F \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C\"), __jsx(\"div\", {\n    className: isMobileApp ? classes.nameM : classes.priceAll,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335\n    },\n    __self: this\n  }, \"\".concat(allPrice, \" \\u0441\\u043E\\u043C\"))), __jsx(\"div\", {\n    className: isMobileApp ? classes.buyM : classes.buyD,\n    onClick: function onClick() {\n      if (allPrice > 0) {\n        if (authenticated) {\n          if (profile.role === 'агент' && client._id && client.address.length > 0 && client.address[0].length > 0 && client.name.length > 0 && client.phone.length > 0 || profile.role !== 'агент' && data.client.address.length > 0 && data.client.address[0].length > 0 && data.client.name.length > 0 && data.client.phone.length > 0) {\n            setMiniDialog('Купить', __jsx(BuyBasket, {\n              bonus: bonus,\n              client: profile.role === 'агент' ? client : data.client,\n              allPrice: allPrice,\n              organization: organization,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 344\n              },\n              __self: this\n            }));\n            showMiniDialog(true);\n          } else showSnackBar('Пожалуйста заполните все поля');\n        } else {\n          setMiniDialog('Купить', __jsx(Sign, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 350\n            },\n            __self: this\n          }));\n          showMiniDialog(true);\n        }\n      } else showSnackBar('Добавьте товар в корзину');\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337\n    },\n    __self: this\n  }, \"\\u041A\\u0423\\u041F\\u0418\\u0422\\u042C\")));\n});\n\nBasket.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref7 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee7(ctx) {\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            if (!['client', 'агент'].includes(ctx.store.getState().user.profile.role) && ctx.store.getState().user.authenticated) if (ctx.res) {\n              ctx.res.writeHead(302, {\n                Location: '/'\n              });\n              ctx.res.end();\n            } else Router.push('/');\n            _context7.t0 = _objectSpread;\n            _context7.t1 = {};\n            _context7.next = 5;\n            return getBasket();\n\n          case 5:\n            _context7.t2 = _context7.sent;\n\n            if (!ctx.store.getState().user.profile._id) {\n              _context7.next = 12;\n              break;\n            }\n\n            _context7.next = 9;\n            return getClient({\n              _id: ctx.store.getState().user.profile._id\n            });\n\n          case 9:\n            _context7.t3 = _context7.sent;\n            _context7.next = 13;\n            break;\n\n          case 12:\n            _context7.t3 = {};\n\n          case 13:\n            _context7.t4 = _context7.t3;\n            _context7.next = 16;\n            return getBonusesClient({\n              search: '',\n              sort: '-createdAt'\n            });\n\n          case 16:\n            _context7.t5 = _context7.sent;\n            _context7.t6 = (0, _context7.t0)(_context7.t1, _context7.t2, _context7.t4, _context7.t5);\n            return _context7.abrupt(\"return\", {\n              data: _context7.t6\n            });\n\n          case 19:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n\n  return function (_x2) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nfunction mapStateToProps(state) {\n  return {\n    app: state.app,\n    user: state.user\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch),\n    snackbarActions: bindActionCreators(snackbarActions, dispatch)\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Basket);","map":{"version":3,"sources":["C:\\projects\\azyk\\azyk-admin\\pages\\basket.js"],"names":["Head","React","useState","useEffect","App","connect","pageListStyle","Card","CardContent","IconButton","CancelIcon","Table","TableBody","TableCell","TableHead","TableRow","bindActionCreators","mini_dialogActions","snackbarActions","getBasket","setBasket","deleteBasket","getClient","Router","BuyBasket","Sign","Confirmation","urlMain","InputLabel","MenuItem","FormControl","Select","getBonusesClient","TextField","getClients","Basket","memo","props","user","authenticated","profile","classes","setMiniDialog","showMiniDialog","showSnackBar","data","console","log","baskets","list","setList","bonus","setBonus","_id","name","organization","setOrganization","handleOrganization","event","organizations","findIndex","element","target","value","setOrganizations","client","setClient","handleClient","clients","setClients","allPrice","setAllPrice","isMobileApp","app","increment","idx","count","setBasketChange","decrement","JSON","parse","localStorage","basket","removeBasketChange","action","splice","undefined","role","search","sort","filter","i","item","push","length","calculateAllPrice","bonusesClient","getList","stock","price","address","map","addres","column","width","margin","page","justifyContent","alignItems","input","row","itemM","divImage","mediaM","image","cancelM","height","nameM","counter","marginBottom","marginRight","counterbtn","counternmbr","isNaN","nameField","mediaD","nameD","counterD","counterbtnD","counternmbrD","button","bottomBasketM","bottomBasketD","allPriceM","allPriceD","priceAllText","priceAll","buyM","buyD","phone","getInitialProps","ctx","includes","store","getState","res","writeHead","Location","end","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import Head from 'next/head';\r\nimport React, { useState, useEffect } from 'react';\r\nimport App from '../layouts/App';\r\nimport { connect } from 'react-redux'\r\nimport pageListStyle from '../src/styleMUI/basket/basket'\r\nimport Card from '@material-ui/core/Card';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport { bindActionCreators } from 'redux'\r\nimport * as mini_dialogActions from '../redux/actions/mini_dialog'\r\nimport * as snackbarActions from '../redux/actions/snackbar'\r\nimport { getBasket, setBasket, deleteBasket } from '../src/gql/basket';\r\nimport { getClient } from '../src/gql/client';\r\nimport Router from 'next/router'\r\nimport BuyBasket from '../components/dialog/BuyBasket'\r\nimport Sign from '../components/dialog/Sign'\r\nimport Confirmation from '../components/dialog/Confirmation'\r\nimport { urlMain } from '../redux/constants/other'\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport { getBonusesClient } from '../src/gql/bonusclient'\r\nimport TextField from '@material-ui/core/TextField';\r\nimport {getClients} from '../src/gql/client'\r\n\r\nconst Basket = React.memo((props) => {\r\n    const { authenticated, profile } = props.user;\r\n    const classes = pageListStyle();\r\n    const { setMiniDialog, showMiniDialog } = props.mini_dialogActions;\r\n    const { showSnackBar } = props.snackbarActions;\r\n    const { data } = props;\r\n    console.log(data)\r\n    let [list, setList] = useState(data.baskets);\r\n    let [bonus, setBonus] = useState({});\r\n    let [organization, setOrganization] = useState({_id: '', name: ''});\r\n    let handleOrganization =  (event) => {\r\n        setOrganization(organizations[organizations.findIndex(element => element._id===event.target.value)])\r\n    };\r\n    let [organizations, setOrganizations] = useState([]);\r\n    let [client, setClient] = useState({_id: '', name: ''});\r\n    let handleClient =  (event) => {\r\n        setClient(clients[clients.findIndex(element => element._id===event.target.value)])\r\n    };\r\n    let [clients, setClients] = useState([]);\r\n    let [allPrice, setAllPrice] = useState(0);\r\n    const { isMobileApp } = props.app;\r\n    let increment = (idx)=>{\r\n        list[idx].count+=1\r\n        setBasketChange(idx, list[idx].count)\r\n        setList([...list])\r\n    }\r\n    let decrement = (idx)=>{\r\n        if(list[idx].count>1) {\r\n            list[idx].count -= 1\r\n            setBasketChange(idx, list[idx].count)\r\n            setList([...list])\r\n        }\r\n    }\r\n    let setBasketChange= (idx, count)=>{\r\n        if(authenticated)\r\n            setBasket({_id: list[idx]._id, count: count})\r\n        else {\r\n            let list = JSON.parse(localStorage.basket);\r\n            list[idx].count = count;\r\n            localStorage.basket = JSON.stringify(list);\r\n        }\r\n    }\r\n    let removeBasketChange= async (idx)=>{\r\n        const action = async() => {\r\n            if(authenticated) {\r\n                setList((await deleteBasket([list[idx]._id])).baskets)\r\n            } else {\r\n                let list = JSON.parse(localStorage.basket)\r\n                list.splice(idx, 1)\r\n                localStorage.basket = JSON.stringify(list)\r\n                setList(list)\r\n            }\r\n        }\r\n        setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n        showMiniDialog(true)\r\n    }\r\n    useEffect(()=>{\r\n        (async()=>{\r\n            if(!authenticated){\r\n                if(localStorage.basket==undefined) {\r\n                    localStorage.basket = JSON.stringify([])\r\n                }\r\n                setList(JSON.parse(localStorage.basket))\r\n            }\r\n            else if(profile.role==='агент') {\r\n                setClients((await getClients({search: '', sort: '-name', filter: ''})).clients)\r\n            }\r\n        })()\r\n    },[])\r\n    useEffect(()=>{\r\n        (async()=>{\r\n            organizations = []\r\n            for(let i=0; i<list.length; i++){\r\n                if(organizations.findIndex(element => element._id===list[i].item.organization._id)===-1){\r\n                    organizations.push(list[i].item.organization)\r\n                }\r\n            }\r\n            setOrganizations([...organizations])\r\n            if(organizations.length>0)\r\n                setOrganization({...organizations[0]})\r\n        })()\r\n    },[list])\r\n    useEffect(()=>{\r\n        calculateAllPrice()\r\n        bonus = {}\r\n        for(let i=0; i<data.bonusesClient.length; i++){\r\n            if(organization._id===data.bonusesClient[i].bonus.organization._id){\r\n                bonus = data.bonusesClient[i]\r\n            }\r\n        }\r\n        setBonus(bonus)\r\n    },[list, organization])\r\n    let getList = async()=>{\r\n        setList((await getBasket()).baskets)\r\n    };\r\n    let calculateAllPrice = async()=>{\r\n        let allPrice = 0\r\n        for(let i=0;i < list.length; i++){\r\n            if(list[i].item.organization._id===organization._id)\r\n                allPrice+=((list[i].item.stock===0||list[i].item.stock===undefined?list[i].item.price:list[i].item.stock)*list[i].count)\r\n        }\r\n        setAllPrice(allPrice)\r\n    };\r\n\r\n    //привести к геолокации\r\n    if(data.client&&!Array.isArray(data.client.address[0])) data.client.address.map((addres)=>[addres])\r\n\r\n    return (\r\n        <App getList={getList} pageName='Корзина'>\r\n            <Head>\r\n                <title>Корзина</title>\r\n                <meta name='description' content='Азык – это онлайн платформа для заказа товаров оптом, разработанная специально для малого и среднего бизнеса.  Она объединяет производителей и торговые точки напрямую, сокращая расходы и повышая продажи. Азык предоставляет своим пользователям мощные технологии для масштабирования и развития своего бизнеса.' />\r\n                <meta property='og:title' content='Корзина' />\r\n                <meta property='og:description' content='Азык – это онлайн платформа для заказа товаров оптом, разработанная специально для малого и среднего бизнеса.  Она объединяет производителей и торговые точки напрямую, сокращая расходы и повышая продажи. Азык предоставляет своим пользователям мощные технологии для масштабирования и развития своего бизнеса.' />\r\n                <meta property='og:type' content='website' />\r\n                <meta property='og:image' content={`${urlMain}/static/512x512.png`} />\r\n                <meta property=\"og:url\" content={`${urlMain}/basket`} />\r\n                <link rel='canonical' href={`${urlMain}/basket`}/>\r\n            </Head>\r\n                {\r\n                        isMobileApp?\r\n                            <div className={classes.column} style={{width: 'calc(100% - 16px)', margin: 8}}>\r\n                                <Card className={classes.page}>\r\n                                      <CardContent className={classes.column} style={isMobileApp?{}:{justifyContent: 'start', alignItems: 'flex-start'}}>\r\n                                          {\r\n                                              profile.role==='агент'?\r\n                                                  <TextField\r\n                                                      select\r\n                                                      label='Клиент'\r\n                                                      value={client._id}\r\n                                                      onChange={handleClient}\r\n                                                      helperText='Клиент'\r\n                                                      className={classes.input}\r\n                                                  >\r\n                                                      {clients.map((element)=>\r\n                                                          <MenuItem key={element._id} value={element._id}>{element.name}</MenuItem>\r\n                                                      )}\r\n                                                  </TextField>\r\n                                                  :\r\n                                                  <TextField\r\n                                                      select\r\n                                                      label='Организация'\r\n                                                      value={organization._id}\r\n                                                      onChange={handleOrganization}\r\n                                                      helperText='Организация'\r\n                                                      className={classes.input}\r\n                                                  >\r\n                                                      {organizations.map((element)=>\r\n                                                          <MenuItem key={element._id} value={element._id}>{element.name}</MenuItem>\r\n                                                      )}\r\n                                                  </TextField>\r\n                                          }\r\n                                    </CardContent>\r\n                                </Card>\r\n                                {\r\n                                    list.map((row, idx) => {\r\n                                        if(row.item.organization._id===organization._id)\r\n                                            return (\r\n                                                <Card className={classes.page} key={idx}>\r\n                                                    <CardContent className={classes.column} style={isMobileApp ? {} : {\r\n                                                        justifyContent: 'start',\r\n                                                        alignItems: 'flex-start'\r\n                                                    }}>\r\n                                                        <div className={classes.itemM}>\r\n                                                            <div className={classes.divImage}>\r\n                                                                <img className={classes.mediaM} src={row.item.image}/>\r\n                                                                <IconButton onClick={() => {\r\n                                                                    removeBasketChange(idx)\r\n                                                                }} color=\"primary\" className={classes.cancelM}>\r\n                                                                    <CancelIcon style={{height: 40, width: 40}}/>\r\n                                                                </IconButton>\r\n                                                            </div>\r\n                                                            <br/>\r\n                                                            <div className={classes.nameM}>\r\n                                                                {row.item.name}\r\n                                                            </div>\r\n                                                            <br/>\r\n                                                            <div className={classes.counter}\r\n                                                                 style={isMobileApp ? {marginBottom: 20} : {marginRight: 20}}>\r\n                                                                <div className={classes.counterbtn} onClick={() => {\r\n                                                                    decrement(idx)\r\n                                                                }}>–\r\n                                                                </div>\r\n                                                                <input type='text' className={classes.counternmbr}\r\n                                                                       value={row.count} onChange={(event) => {\r\n                                                                    list[idx].count = isNaN(event.target.value) || event.target.value.length === 0 ? 0 : parseInt(event.target.value)\r\n                                                                    setBasketChange(idx, list[idx].count)\r\n                                                                    setList([...list])\r\n                                                                }}/>\r\n                                                                <div className={classes.counterbtn} onClick={() => {\r\n                                                                    increment(idx)\r\n                                                                }}>+\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div>\r\n                                                                <div className={classes.row}>\r\n                                                                    <div className={classes.nameField}>\r\n                                                                        Цена\r\n                                                                    </div>\r\n                                                                    <div className={classes.value}>\r\n                                                                        {`${row.item.stock === 0 || row.item.stock === undefined ? row.item.price : row.item.stock} сом`}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                                <div className={classes.row}>\r\n                                                                    <div className={classes.nameField}>\r\n                                                                        Итого\r\n                                                                    </div>\r\n                                                                    <div className={classes.value}>\r\n                                                                        {`${(row.item.stock === 0 || row.item.stock === undefined ? row.item.price : row.item.stock) * row.count} сом`}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </CardContent>\r\n                                                </Card>\r\n                                            )\r\n                                        }\r\n                                    )\r\n                                }\r\n                                <div style={{height: 70}}/>\r\n                            </div>\r\n                            :\r\n                            <>\r\n                            <Card className={classes.page}>\r\n                                <CardContent className={classes.column} style={isMobileApp?{}:{justifyContent: 'start', alignItems: 'flex-start'}}>\r\n                                <Table aria-label=\"simple table\">\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell>\r\n                                            {\r\n                                                profile.role==='агент'?\r\n                                                    <FormControl className={classes.input}>\r\n                                                        <InputLabel>Клиент</InputLabel>\r\n                                                        <Select value={client._id} onChange={handleClient}>\r\n                                                            {clients.map((element)=>\r\n                                                                <MenuItem key={element._id} value={element._id} ola={element.name}>{element.name}</MenuItem>\r\n                                                            )}\r\n                                                        </Select>\r\n                                                    </FormControl>\r\n                                                    :\r\n                                                    <FormControl className={classes.input}>\r\n                                                        <InputLabel>Организация</InputLabel>\r\n                                                        <Select value={organization._id} onChange={handleOrganization}>\r\n                                                            {organizations.map((element)=>\r\n                                                                <MenuItem key={element._id} value={element._id} ola={element.name}>{element.name}</MenuItem>\r\n                                                            )}\r\n                                                        </Select>\r\n                                                    </FormControl>\r\n                                            }\r\n                                        </TableCell>\r\n                                        <TableCell align=\"left\">Количество</TableCell>\r\n                                        <TableCell align=\"left\">Цена</TableCell>\r\n                                        <TableCell align=\"left\">Итого</TableCell>\r\n                                        <TableCell align=\"center\">Отменить</TableCell>\r\n                                    </TableRow>\r\n                                    </TableHead>\r\n                                    <TableBody>\r\n                                        {list.map((row, idx) => {\r\n                                            if(row.item.organization._id===organization._id)\r\n                                            return (\r\n                                                <TableRow key={idx}>\r\n                                                <TableCell component=\"th\" scope=\"row\" >\r\n                                                    <div className={classes.row}>\r\n                                                        <img className={classes.mediaD} src={row.item.image}/>\r\n                                                        <div className={classes.nameD}>\r\n                                                            {row.item.name}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </TableCell>\r\n                                                <TableCell align=\"left\">\r\n\r\n                                                    <div className={classes.counterD} style={isMobileApp?{marginBottom: 20}:{marginRight: 20}}>\r\n                                                        <div className={classes.counterbtnD} onClick={()=>{decrement(idx)}}>–</div>\r\n                                                        <input type='text' className={classes.counternmbrD} value={row.count} onChange={(event)=>{\r\n                                                            list[idx].count = isNaN(event.target.value)||event.target.value.length===0?0:parseInt(event.target.value)\r\n                                                            setBasketChange(idx, list[idx].count)\r\n                                                            setList([...list])\r\n                                                        }}/>\r\n                                                        <div className={classes.counterbtnD} onClick={()=>{increment(idx)}}>+</div>\r\n                                                    </div>\r\n\r\n                                                </TableCell>\r\n                                                <TableCell align=\"left\">{`${row.item.stock===0||row.item.stock===undefined?row.item.price:row.item.stock*row.count} сом`}</TableCell>\r\n                                                <TableCell align=\"left\">{`${(row.item.stock===0||row.item.stock===undefined?row.item.price:row.item.stock*row.count)*row.count} сом`}</TableCell>\r\n                                                <TableCell align=\"center\">\r\n                                                    <IconButton onClick={()=>{removeBasketChange(idx)}} color=\"primary\" className={classes.button} aria-label=\"add to shopping cart\">\r\n                                                        <CancelIcon />\r\n                                                    </IconButton>\r\n                                                </TableCell>\r\n                                            </TableRow>\r\n                                            )\r\n                                        })}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </CardContent>\r\n                            </Card>\r\n                            <div style={{height: 70}}/>\r\n                            </>\r\n                    }\r\n            <div className={isMobileApp?classes.bottomBasketM:classes.bottomBasketD}>\r\n                <div className={isMobileApp?classes.allPriceM:classes.allPriceD}>\r\n                    <div className={isMobileApp?classes.value:classes.priceAllText}>Общая стоимость</div>\r\n                    <div className={isMobileApp?classes.nameM:classes.priceAll}>{`${allPrice} сом`}</div>\r\n                </div>\r\n                <div className={isMobileApp?classes.buyM:classes.buyD} onClick={()=>{\r\n                    if(allPrice>0)\r\n                        if (authenticated)\r\n                            if (\r\n                                (profile.role==='агент'&&client._id&&client.address.length>0&&client.address[0].length>0&&client.name.length>0&&client.phone.length>0)||\r\n                                (profile.role!=='агент'&&data.client.address.length>0&&data.client.address[0].length>0&&data.client.name.length>0&&data.client.phone.length>0)\r\n                            ) {\r\n                                setMiniDialog('Купить', <BuyBasket bonus={bonus} client={profile.role==='агент'?client:data.client} allPrice={allPrice} organization={organization}/>)\r\n                                showMiniDialog(true)\r\n                            }\r\n                            else\r\n                                showSnackBar('Пожалуйста заполните все поля')\r\n                        else {\r\n                            setMiniDialog('Купить', <Sign/>)\r\n                            showMiniDialog(true)\r\n                        }\r\n                    else\r\n                        showSnackBar('Добавьте товар в корзину')\r\n                }}>\r\n                    КУПИТЬ\r\n                </div>\r\n            </div>\r\n        </App>\r\n    )\r\n})\r\n\r\nBasket.getInitialProps = async function(ctx) {\r\n    if(!['client', 'агент'].includes(ctx.store.getState().user.profile.role)&&ctx.store.getState().user.authenticated)\r\n        if(ctx.res) {\r\n            ctx.res.writeHead(302, {\r\n                Location: '/'\r\n            })\r\n            ctx.res.end()\r\n        } else\r\n            Router.push('/')\r\n    return {\r\n        data: {\r\n            ...await getBasket(),\r\n            ...(ctx.store.getState().user.profile._id?await getClient({_id: ctx.store.getState().user.profile._id}):{}),\r\n            ...await getBonusesClient({search: '', sort: '-createdAt'})\r\n        }\r\n    };\r\n};\r\n\r\nfunction mapStateToProps (state) {\r\n    return {\r\n        app: state.app,\r\n        user: state.user,\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch),\r\n        snackbarActions: bindActionCreators(snackbarActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Basket);"]},"metadata":{},"sourceType":"module"}