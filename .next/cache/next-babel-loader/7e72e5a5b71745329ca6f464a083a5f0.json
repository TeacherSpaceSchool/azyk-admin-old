{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\n\n/* eslint-disable no-extra-boolean-cast */\nimport { urlGQL } from '../redux/constants/other';\nimport { ApolloClient } from 'apollo-client';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport fetch from 'node-fetch';\nimport { getJWT } from './lib';\nimport { setContext } from 'apollo-link-context';\nimport { ApolloLink } from 'apollo-link';\nimport { createUploadLink } from 'apollo-upload-client';\nexport const getClientGQL = req => {\n  const uploadLink = createUploadLink({\n    uri: urlGQL,\n    fetch: fetch,\n    credentials: 'include'\n  });\n  const authLink = setContext((_, {\n    headers\n  }) => {\n    return {\n      headers: _objectSpread({}, headers, {\n        authorization: getJWT(req ? req.headers.cookie : document.cookie) ? `Bearer ${getJWT(req ? req.headers.cookie : document.cookie)}` : ''\n      })\n    };\n  });\n  const link = ApolloLink.from([authLink, uploadLink]);\n  const client = new ApolloClient({\n    ssrMode: true,\n    link: link,\n    cache: new InMemoryCache(),\n    defaultOptions: {\n      watchQuery: {\n        fetchPolicy: 'cache-and-network',\n        errorPolicy: 'ignore'\n      },\n      query: {\n        fetchPolicy: 'network-only',\n        errorPolicy: 'all'\n      },\n      mutate: {\n        errorPolicy: 'all'\n      }\n    }\n  });\n  return client;\n};","map":{"version":3,"sources":["C:\\projects\\azyk\\azyk-admin\\src\\getClientGQL.js"],"names":["urlGQL","ApolloClient","InMemoryCache","fetch","getJWT","setContext","ApolloLink","createUploadLink","getClientGQL","req","uploadLink","uri","credentials","authLink","_","headers","authorization","cookie","document","link","from","client","ssrMode","cache","defaultOptions","watchQuery","fetchPolicy","errorPolicy","query","mutate"],"mappings":";;AAAA;AACA,SAASA,MAAT,QAAuB,0BAAvB;AACA,SAASC,YAAT,QAA6B,eAA7B;AACA,SAASC,aAAT,QAA8B,uBAA9B;AACA,OAAOC,KAAP,MAAkB,YAAlB;AACA,SAASC,MAAT,QAAuB,OAAvB;AACA,SAASC,UAAT,QAA2B,qBAA3B;AACA,SAASC,UAAT,QAA4B,aAA5B;AACA,SAASC,gBAAT,QAAiC,sBAAjC;AAEA,OAAO,MAAMC,YAAY,GAAIC,GAAD,IAAS;AAC7B,QAAMC,UAAU,GAAGH,gBAAgB,CAAC;AAChCI,IAAAA,GAAG,EAAEX,MAD2B;AAEhCG,IAAAA,KAAK,EAAEA,KAFyB;AAGhCS,IAAAA,WAAW,EAAE;AAHmB,GAAD,CAAnC;AAKA,QAAMC,QAAQ,GAAGR,UAAU,CAAC,CAACS,CAAD,EAAI;AAAEC,IAAAA;AAAF,GAAJ,KAAoB;AAC5C,WAAO;AACHA,MAAAA,OAAO,oBACAA,OADA;AAEHC,QAAAA,aAAa,EAAEZ,MAAM,CAACK,GAAG,GAACA,GAAG,CAACM,OAAJ,CAAYE,MAAb,GAAoBC,QAAQ,CAACD,MAAjC,CAAN,GAAkD,UAASb,MAAM,CAACK,GAAG,GAACA,GAAG,CAACM,OAAJ,CAAYE,MAAb,GAAoBC,QAAQ,CAACD,MAAjC,CAAyC,EAA1G,GAA8G;AAF1H;AADJ,KAAP;AAMH,GAP0B,CAA3B;AAQA,QAAME,IAAI,GAAGb,UAAU,CAACc,IAAX,CAAgB,CACzBP,QADyB,EAEzBH,UAFyB,CAAhB,CAAb;AAIA,QAAMW,MAAM,GAAG,IAAIpB,YAAJ,CAAiB;AAC5BqB,IAAAA,OAAO,EAAE,IADmB;AAE5BH,IAAAA,IAAI,EAAEA,IAFsB;AAG5BI,IAAAA,KAAK,EAAE,IAAIrB,aAAJ,EAHqB;AAI5BsB,IAAAA,cAAc,EAAE;AACZC,MAAAA,UAAU,EAAE;AACRC,QAAAA,WAAW,EAAE,mBADL;AAERC,QAAAA,WAAW,EAAE;AAFL,OADA;AAKZC,MAAAA,KAAK,EAAE;AACHF,QAAAA,WAAW,EAAE,cADV;AAEHC,QAAAA,WAAW,EAAE;AAFV,OALK;AASZE,MAAAA,MAAM,EAAE;AACJF,QAAAA,WAAW,EAAE;AADT;AATI;AAJY,GAAjB,CAAf;AAmBA,SAAON,MAAP;AACH,CAtCE","sourcesContent":["/* eslint-disable no-extra-boolean-cast */\r\nimport { urlGQL } from '../redux/constants/other';\r\nimport { ApolloClient } from 'apollo-client';\r\nimport { InMemoryCache } from 'apollo-cache-inmemory';\r\nimport fetch from 'node-fetch';\r\nimport { getJWT } from './lib'\r\nimport { setContext } from 'apollo-link-context';\r\nimport { ApolloLink  } from 'apollo-link';\r\nimport { createUploadLink } from 'apollo-upload-client'\r\n\r\nexport const getClientGQL = (req) => {\r\n        const uploadLink = createUploadLink({\r\n            uri: urlGQL,\r\n            fetch: fetch,\r\n            credentials: 'include'\r\n        });\r\n        const authLink = setContext((_, { headers }) => {\r\n            return {\r\n                headers: {\r\n                    ...headers,\r\n                    authorization: getJWT(req?req.headers.cookie:document.cookie) ? `Bearer ${getJWT(req?req.headers.cookie:document.cookie)}` : '',\r\n                }\r\n            }\r\n        });\r\n        const link = ApolloLink.from([\r\n            authLink,\r\n            uploadLink\r\n        ]);\r\n        const client = new ApolloClient({\r\n            ssrMode: true,\r\n            link: link,\r\n            cache: new InMemoryCache(),\r\n            defaultOptions: {\r\n                watchQuery: {\r\n                    fetchPolicy: 'cache-and-network',\r\n                    errorPolicy: 'ignore',\r\n                },\r\n                query: {\r\n                    fetchPolicy: 'network-only',\r\n                    errorPolicy: 'all',\r\n                },\r\n                mutate: {\r\n                    errorPolicy: 'all',\r\n                },\r\n            },\r\n\r\n        });\r\n        return client\r\n    }"]},"metadata":{},"sourceType":"module"}