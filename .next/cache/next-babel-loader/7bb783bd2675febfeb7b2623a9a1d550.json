{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport Link from 'next/link';\nimport React, { useState, useEffect } from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport LocalGroceryStore from '@material-ui/icons/LocalGroceryStore';\nimport Star from '@material-ui/icons/Star';\nimport ExitToApp from '@material-ui/icons/ExitToApp';\nimport AssignmentInd from '@material-ui/icons/AssignmentInd';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport * as mini_dialogActions from '../../redux/actions/mini_dialog';\nimport * as userActions from '../../redux/actions/user';\nimport * as appActions from '../../redux/actions/app';\nimport appbarStyle from '../../src/styleMUI/appbar';\nimport { getCountBasket } from '../../src/gql/basket';\nimport ArrowUpward from '@material-ui/icons/ArrowUpward';\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\nimport Paper from '@material-ui/core/Paper';\nimport Cancel from '@material-ui/icons/Cancel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Input from '@material-ui/core/Input';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Search from '@material-ui/icons/SearchRounded';\nimport Sort from '@material-ui/icons/SortRounded';\nimport FilterList from '@material-ui/icons/FilterListRounded';\nimport PermIdentity from '@material-ui/icons/PermIdentity';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Menu from '@material-ui/core/Menu';\nimport dynamic from 'next/dynamic';\nimport Badge from '@material-ui/core/Badge';\nvar Sign = dynamic(function () {\n  return import('../dialog/Sign');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../dialog/Sign')];\n    },\n    modules: ['../dialog/Sign']\n  }\n});\nvar Confirmation = dynamic(function () {\n  return import('../dialog/Confirmation');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../dialog/Confirmation')];\n    },\n    modules: ['../dialog/Confirmation']\n  }\n});\nvar MyAppBar = React.memo(function (props) {\n  //props\n  var classes = appbarStyle();\n  var filters = props.filters,\n      sorts = props.sorts,\n      pageName = props.pageName;\n  var _props$app = props.app,\n      drawer = _props$app.drawer,\n      search = _props$app.search,\n      filter = _props$app.filter,\n      sort = _props$app.sort,\n      isMobileApp = _props$app.isMobileApp,\n      countBasket = _props$app.countBasket;\n  var _props$appActions = props.appActions,\n      showDrawer = _props$appActions.showDrawer,\n      setSearch = _props$appActions.setSearch,\n      setFilter = _props$appActions.setFilter,\n      setSort = _props$appActions.setSort;\n  var _props$user = props.user,\n      authenticated = _props$user.authenticated,\n      profile = _props$user.profile;\n  var _props$mini_dialogAct = props.mini_dialogActions,\n      setMiniDialog = _props$mini_dialogAct.setMiniDialog,\n      showMiniDialog = _props$mini_dialogAct.showMiniDialog;\n  var logout = props.userActions.logout; //state\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      anchorElMobileMenu = _React$useState2[0],\n      setAnchorElMobileMenu = _React$useState2[1];\n\n  var openMobileMenu = Boolean(anchorElMobileMenu);\n\n  var handleMobileMenu = function handleMobileMenu(event) {\n    setAnchorElMobileMenu(event.currentTarget);\n  };\n\n  var handleCloseMobileMenu = function handleCloseMobileMenu() {\n    setAnchorElMobileMenu(null);\n  };\n\n  var _useState = useState(null),\n      anchorElSort = _useState[0],\n      setAnchorElSort = _useState[1];\n\n  var openSort = Boolean(anchorElSort);\n\n  var handleMenuSort = function handleMenuSort(event) {\n    setAnchorElSort(event.currentTarget);\n  };\n\n  var handleCloseSort = function handleCloseSort() {\n    setAnchorElSort(null);\n  };\n\n  var _useState2 = useState(null),\n      anchorElProfile = _useState2[0],\n      setAnchorElProfile = _useState2[1];\n\n  var openProfile = Boolean(anchorElProfile);\n\n  var handleMenuProfile = function handleMenuProfile(event) {\n    setAnchorElProfile(event.currentTarget);\n  };\n\n  var handleCloseProfile = function handleCloseProfile() {\n    setAnchorElProfile(null);\n  };\n\n  var _useState3 = useState(null),\n      anchorElFilter = _useState3[0],\n      setAnchorElFilter = _useState3[1];\n\n  var openFilter = Boolean(anchorElFilter);\n\n  var handleMenuFilter = function handleMenuFilter(event) {\n    setAnchorElFilter(event.currentTarget);\n  };\n\n  var handleCloseFilter = function handleCloseFilter() {\n    setAnchorElFilter(null);\n  };\n\n  var _useState4 = useState(false),\n      openSearch = _useState4[0],\n      setOpenSearch = _useState4[1];\n\n  var handleSearch = function handleSearch(event) {\n    setSearch(event.target.value);\n  };\n\n  useEffect(function () {\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              getCountBasket();\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  }, []);\n  return __jsx(\"div\", {\n    className: classes.root\n  }, __jsx(AppBar, {\n    position: \"fixed\",\n    className: classes.appBar\n  }, __jsx(Toolbar, null, isMobileApp ? __jsx(IconButton, {\n    edge: \"start\",\n    \"aria-owns\": \"menu-appbar\",\n    \"aria-haspopup\": \"true\",\n    onClick: function onClick() {\n      showDrawer(!drawer);\n    },\n    color: \"inherit\"\n  }, __jsx(MenuIcon, null)) : __jsx(IconButton, {\n    \"aria-owns\": \"menu-appbar\",\n    \"aria-haspopup\": \"true\",\n    onClick: function onClick() {\n      showDrawer(!drawer);\n    },\n    color: \"inherit\"\n  }, __jsx(MenuIcon, null)), __jsx(Typography, {\n    variant: \"h6\",\n    className: classes.title\n  }, pageName), isMobileApp ? openSearch ? __jsx(Paper, {\n    className: classes.searchM\n  }, __jsx(FormControl, {\n    className: classes.textField\n  }, __jsx(Input, {\n    id: \"adornment-password\",\n    type: 'login',\n    value: search,\n    onChange: handleSearch,\n    endAdornment: __jsx(InputAdornment, {\n      position: \"end\"\n    }, __jsx(IconButton, {\n      \"aria-label\": \"Search\",\n      onClick: function onClick() {\n        setSearch('');\n        setOpenSearch(false);\n      }\n    }, __jsx(Cancel, null)))\n  }))) : __jsx(React.Fragment, null, __jsx(IconButton, {\n    \"aria-owns\": openMobileMenu ? 'menu-appbar' : undefined,\n    \"aria-haspopup\": \"true\",\n    onClick: handleMobileMenu,\n    color: \"inherit\"\n  }, __jsx(Search, null)), __jsx(Menu, {\n    id: \"menu-appbar\",\n    anchorEl: anchorElMobileMenu,\n    anchorOrigin: {\n      vertical: 'bottom',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'bottom',\n      horizontal: 'right'\n    },\n    open: openMobileMenu,\n    onClose: handleCloseMobileMenu\n  }, __jsx(MenuItem, {\n    onClick: function onClick() {\n      setOpenSearch(true);\n      handleCloseMobileMenu();\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(Search, null), \"\\xA0\\u041F\\u043E\\u0438\\u0441\\u043A\")), filters && filters.length > 0 ? [__jsx(MenuItem, {\n    onClick: handleMenuFilter\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(FilterList, null), \"\\xA0\\u0424\\u0438\\u043B\\u044C\\u0442\\u0440\")), __jsx(Menu, {\n    key: \"filters2\",\n    id: \"menu-appbar\",\n    anchorEl: anchorElFilter,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    open: openFilter,\n    onClose: handleCloseFilter\n  }, filters.map(function (elem, idx) {\n    return __jsx(MenuItem, {\n      key: idx,\n      style: {\n        background: filter === elem.value ? 'rgba(51, 143, 255, 0.29)' : '#fff'\n      },\n      onClick: function onClick() {\n        setFilter(elem.value);\n        handleCloseFilter();\n      }\n    }, elem.name);\n  }))] : null, sorts && sorts.length > 0 ? [__jsx(MenuItem, {\n    onClick: handleMenuSort\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(Sort, null), \"\\xA0\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430\")), __jsx(Menu, {\n    key: \"sort2\",\n    id: \"menu-appbar\",\n    anchorEl: anchorElSort,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'left'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'left'\n    },\n    open: openSort,\n    onClose: handleCloseSort\n  }, sorts.map(function (elem, idx) {\n    return __jsx(MenuItem, {\n      key: idx,\n      onClick: function onClick() {\n        sort === \"-\".concat(elem.field) ? setSort(elem.field) : setSort(\"-\".concat(elem.field));\n        /*handleCloseSort();handleCloseMobileMenu()*/\n      }\n    }, sort === \"-\".concat(elem.field) ? __jsx(ArrowDownward, null) : sort === elem.field ? __jsx(ArrowUpward, null) : __jsx(\"div\", {\n      style: {\n        width: '24px'\n      }\n    }), elem.name);\n  }))] : null), __jsx(Tooltip, {\n    title: \"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"\n  }, __jsx(IconButton, {\n    \"aria-owns\": \"menu-appbar\",\n    \"aria-haspopup\": \"true\",\n    color: \"inherit\",\n    onClick: handleMenuProfile\n  }, __jsx(Badge, {\n    badgeContent: countBasket,\n    color: \"secondary\"\n  }, __jsx(PermIdentity, null)))), __jsx(Menu, {\n    id: \"menu-appbar\",\n    anchorEl: anchorElProfile,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    open: openProfile,\n    onClose: handleCloseProfile\n  }, !authenticated || profile.role === 'client' ? __jsx(React.Fragment, null, __jsx(MenuItem, null, __jsx(Badge, {\n    badgeContent: countBasket,\n    color: \"secondary\"\n  }, __jsx(Link, {\n    href: \"/basket\"\n  }, __jsx(\"a\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(LocalGroceryStore, null), \"\\xA0\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\\xA0\\xA0\")))), __jsx(MenuItem, null, __jsx(Link, {\n    href: \"/favorite\"\n  }, __jsx(\"a\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(Star, null), \"\\xA0\\u0418\\u0437\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435\")))) : null, authenticated && profile.role !== 'admin' ? __jsx(MenuItem, null, __jsx(Link, {\n    href: \"/\".concat(profile.role === 'client' ? 'client' : 'employment', \"/[id]\"),\n    as: \"/\".concat(profile.role === 'client' ? 'client' : 'employment', \"/\").concat(profile._id)\n  }, __jsx(\"a\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(AssignmentInd, null), \"\\xA0\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"))) : null, authenticated ? __jsx(MenuItem, {\n    onClick: function onClick() {\n      var action =\n      /*#__PURE__*/\n      function () {\n        var _ref2 = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee2() {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  logout();\n\n                case 1:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function action() {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n        action: action\n      }));\n      showMiniDialog(true);\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(ExitToApp, null), \"\\xA0\\u0412\\u044B\\u0439\\u0442\\u0438\")) : __jsx(MenuItem, {\n    onClick: function onClick() {\n      setMiniDialog('Вход', __jsx(Sign, {\n        isMobileApp: isMobileApp\n      }));\n      showMiniDialog(true);\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(ExitToApp, null), \"\\xA0\\u0412\\u043E\\u0439\\u0442\\u0438\")))) : openSearch ? __jsx(Paper, {\n    className: classes.searchD\n  }, __jsx(FormControl, {\n    className: classes.textField\n  }, __jsx(Input, {\n    id: \"adornment-password\",\n    type: 'login',\n    value: search,\n    onChange: handleSearch,\n    endAdornment: __jsx(InputAdornment, {\n      position: \"end\"\n    }, __jsx(IconButton, {\n      \"aria-label\": \"Search\",\n      onClick: function onClick() {\n        setSearch('');\n        setOpenSearch(false);\n      }\n    }, __jsx(Cancel, null)))\n  }))) : __jsx(React.Fragment, null, filters && filters.length > 0 ? __jsx(React.Fragment, null, __jsx(Tooltip, {\n    title: \"\\u0424\\u0438\\u043B\\u044C\\u0442\\u0440\"\n  }, __jsx(IconButton, {\n    \"aria-owns\": openFilter ? 'menu-appbar' : undefined,\n    \"aria-haspopup\": \"true\",\n    onClick: handleMenuFilter,\n    color: \"inherit\"\n  }, __jsx(FilterList, null))), __jsx(Menu, {\n    id: \"menu-appbar\",\n    anchorEl: anchorElFilter,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    open: openFilter,\n    onClose: handleCloseFilter\n  }, filters.map(function (elem, idx) {\n    return __jsx(MenuItem, {\n      key: idx,\n      style: {\n        background: filter === elem.value ? 'rgba(51, 143, 255, 0.29)' : '#fff'\n      },\n      onClick: function onClick() {\n        setFilter(elem.value);\n        handleCloseFilter();\n      }\n    }, elem.name);\n  })), \"\\xA0\") : null, sorts && sorts.length > 0 ? __jsx(React.Fragment, null, __jsx(Tooltip, {\n    title: \"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430\"\n  }, __jsx(IconButton, {\n    \"aria-owns\": openSort ? 'menu-appbar' : undefined,\n    \"aria-haspopup\": \"true\",\n    onClick: handleMenuSort,\n    color: \"inherit\"\n  }, __jsx(Sort, null))), __jsx(Menu, {\n    id: \"menu-appbar\",\n    anchorEl: anchorElSort,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    open: openSort,\n    onClose: handleCloseSort\n  }, sorts.map(function (elem, idx) {\n    return __jsx(MenuItem, {\n      key: idx,\n      onClick: function onClick() {\n        sort === \"-\".concat(elem.field) ? setSort(elem.field) : setSort(\"-\".concat(elem.field));\n        handleCloseSort();\n      }\n    }, sort === \"-\".concat(elem.field) ? __jsx(ArrowDownward, null) : sort === elem.field ? __jsx(ArrowUpward, null) : __jsx(\"div\", {\n      style: {\n        width: '24px'\n      }\n    }), elem.name);\n  })), \"\\xA0\") : null, __jsx(Tooltip, {\n    title: \"\\u041F\\u043E\\u0438\\u0441\\u043A\"\n  }, __jsx(IconButton, {\n    \"aria-owns\": openSearch ? 'menu-appbar' : undefined,\n    \"aria-haspopup\": \"true\",\n    onClick: function onClick() {\n      setOpenSearch(true);\n    },\n    color: \"inherit\"\n  }, __jsx(Search, null))), __jsx(Tooltip, {\n    title: \"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"\n  }, __jsx(IconButton, {\n    \"aria-owns\": \"menu-appbar\",\n    \"aria-haspopup\": \"true\",\n    color: \"inherit\",\n    onClick: handleMenuProfile\n  }, __jsx(Badge, {\n    badgeContent: countBasket,\n    color: \"secondary\"\n  }, __jsx(PermIdentity, null)))), __jsx(Menu, {\n    id: \"menu-appbar\",\n    anchorEl: anchorElProfile,\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'right'\n    },\n    open: openProfile,\n    onClose: handleCloseProfile\n  }, !authenticated || profile.role === 'client' ? __jsx(React.Fragment, null, __jsx(MenuItem, null, __jsx(Badge, {\n    badgeContent: countBasket,\n    color: \"secondary\"\n  }, __jsx(Link, {\n    href: \"/basket\"\n  }, __jsx(\"a\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(LocalGroceryStore, null), \"\\xA0\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\\xA0\\xA0\")))), __jsx(MenuItem, null, __jsx(Link, {\n    href: \"/favorite\"\n  }, __jsx(\"a\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(Star, null), \"\\xA0\\u0418\\u0437\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435\")))) : null, authenticated && profile.role !== 'admin' ? __jsx(MenuItem, null, __jsx(Link, {\n    href: \"/\".concat(profile.role === 'client' ? 'client' : 'employment', \"/[id]\"),\n    as: \"/\".concat(profile.role === 'client' ? 'client' : 'employment', \"/\").concat(profile._id)\n  }, __jsx(\"a\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(AssignmentInd, null), \"\\xA0\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"))) : null, authenticated ? __jsx(MenuItem, {\n    onClick: function onClick() {\n      showDrawer(false);\n\n      var action =\n      /*#__PURE__*/\n      function () {\n        var _ref3 = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee3() {\n          return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  logout();\n\n                case 1:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3);\n        }));\n\n        return function action() {\n          return _ref3.apply(this, arguments);\n        };\n      }();\n\n      setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n        action: action\n      }));\n      showMiniDialog(true);\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(ExitToApp, null), \"\\xA0\\u0412\\u044B\\u0439\\u0442\\u0438\")) : __jsx(MenuItem, {\n    onClick: function onClick() {\n      setMiniDialog('Вход', __jsx(Sign, {\n        isMobileApp: isMobileApp\n      }));\n      showMiniDialog(true);\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      color: '#606060'\n    }\n  }, __jsx(ExitToApp, null), \"\\xA0\\u0412\\u043E\\u0439\\u0442\\u0438\")))))));\n});\n\nfunction mapStateToProps(state) {\n  return {\n    app: state.app,\n    user: state.user\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    appActions: bindActionCreators(appActions, dispatch),\n    userActions: bindActionCreators(userActions, dispatch),\n    mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch)\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAppBar);","map":null,"metadata":{},"sourceType":"module"}