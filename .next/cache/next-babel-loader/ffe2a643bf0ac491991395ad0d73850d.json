{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _Array$isArray from \"@babel/runtime-corejs2/core-js/array/is-array\";\nvar _jsxFileName = \"C:\\\\projects\\\\azyk\\\\azyk-admin\\\\pages\\\\client\\\\[id].js\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport React, { useState } from 'react';\nimport App from '../../layouts/App';\nimport { connect } from 'react-redux';\nimport { getClient } from '../../src/gql/client';\nimport clientStyle from '../../src/styleMUI/client/client';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport Input from '@material-ui/core/Input';\nimport Button from '@material-ui/core/Button';\nimport { bindActionCreators } from 'redux';\nimport * as mini_dialogActions from '../../redux/actions/mini_dialog';\nimport * as userActions from '../../redux/actions/user';\nimport { onoffClient, setClient } from '../../src/gql/client';\nimport Add from '@material-ui/icons/Done';\nimport Remove from '@material-ui/icons/Delete';\nimport IconButton from '@material-ui/core/IconButton';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport Visibility from '@material-ui/icons/Visibility';\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\nimport TextField from '@material-ui/core/TextField';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport Router from 'next/router';\nimport Confirmation from '../../components/dialog/Confirmation';\nvar Client = React.memo(function (props) {\n  var profile = props.user.profile;\n  var classes = clientStyle();\n  var data = props.data;\n  var isMobileApp = props.app.isMobileApp;\n\n  var _useState = useState(data.client !== null ? data.client.user.status : ''),\n      status = _useState[0],\n      setStatus = _useState[1];\n\n  var _useState2 = useState(data.client !== null ? data.client.name : ''),\n      name = _useState2[0],\n      setName = _useState2[1];\n\n  var _useState3 = useState(data.client !== null ? data.client.email : ''),\n      email = _useState3[0],\n      setEmail = _useState3[1];\n\n  var _useState4 = useState(data.client !== null ? data.client.user.phone : ''),\n      phone = _useState4[0],\n      setPhone = _useState4[1]; //привести к геолокации\n\n\n  if (!_Array$isArray(data.client.address[0])) data.client.address.map(function (addres) {\n    return [addres];\n  });\n\n  var _useState5 = useState(data.client !== null ? data.client.address : []),\n      address = _useState5[0],\n      setAddress = _useState5[1];\n\n  var _useState6 = useState(''),\n      newAddress = _useState6[0],\n      setNewAddress = _useState6[1];\n\n  var addAddress = function addAddress() {\n    address = [].concat(_toConsumableArray(address), [[newAddress]]);\n    setAddress(address);\n    setNewAddress('');\n  };\n\n  var editAddress = function editAddress(event, idx) {\n    address[idx][0] = event.target.value;\n    setAddress(_toConsumableArray(address));\n  };\n\n  var deleteAddress = function deleteAddress(idx) {\n    address.splice(idx, 1);\n    setAddress(_toConsumableArray(address));\n  };\n\n  var _useState7 = useState(data.client !== null ? data.client.info : ''),\n      info = _useState7[0],\n      setInfo = _useState7[1];\n\n  var _useState8 = useState(data.client !== null ? data.client.image : ''),\n      preview = _useState8[0],\n      setPreview = _useState8[1];\n\n  var _useState9 = useState(undefined),\n      image = _useState9[0],\n      setImage = _useState9[1];\n\n  var handleChangeImage = function handleChangeImage(event) {\n    setImage(event.target.files[0]);\n    setPreview(URL.createObjectURL(event.target.files[0]));\n  };\n\n  var _props$mini_dialogAct = props.mini_dialogActions,\n      setMiniDialog = _props$mini_dialogAct.setMiniDialog,\n      showMiniDialog = _props$mini_dialogAct.showMiniDialog;\n  var logout = props.userActions.logout;\n\n  var _useState10 = useState(''),\n      newPass = _useState10[0],\n      setNewPass = _useState10[1];\n\n  var handleNewPass = function handleNewPass(event) {\n    setNewPass(event.target.value);\n  };\n\n  var _useState11 = useState('password'),\n      hide = _useState11[0],\n      setHide = _useState11[1];\n\n  var handleHide = function handleHide() {\n    setHide(!hide);\n  };\n\n  return __jsx(App, {\n    filters: data.filterSubCategory,\n    sorts: data.sortSubCategory,\n    pageName: data.client !== null ? data.client.name : 'Ничего не найдено',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, __jsx(Head, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, __jsx(\"title\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, data.client !== null ? data.client.name : 'Ничего не найдено')), __jsx(Card, {\n    className: classes.page,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, __jsx(CardActions, {\n    className: isMobileApp ? classes.column : classes.row,\n    style: isMobileApp ? {} : {\n      justifyContent: 'start',\n      alignItems: 'flex-start'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, data.client !== null ? profile.role === 'admin' || profile._id === data.client.user._id ? __jsx(React.Fragment, null, __jsx(\"label\", {\n    htmlFor: \"contained-button-file\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, __jsx(LazyLoadImage, {\n    placeholderSrc: \"/static/add.png\",\n    effect: \"blur\",\n    className: classes.media,\n    src: preview,\n    alt: 'Добавить',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, __jsx(TextField, {\n    label: \"\\u0418\\u043C\\u044F\",\n    value: name,\n    className: isMobileApp ? classes.inputM : classes.inputD,\n    onChange: function onChange(event) {\n      setName(event.target.value);\n    },\n    inputProps: {\n      'aria-label': 'description'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }), __jsx(Input, {\n    placeholder: \"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n    type: hide ? 'password' : 'text',\n    value: newPass,\n    onChange: handleNewPass,\n    className: isMobileApp ? classes.inputM : classes.inputD,\n    endAdornment: __jsx(InputAdornment, {\n      position: \"end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, __jsx(IconButton, {\n      \"aria-label\": \"Toggle password visibility\",\n      onClick: handleHide,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, hide ? __jsx(VisibilityOff, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }) : __jsx(Visibility, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }))),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }), __jsx(FormControl, {\n    className: isMobileApp ? classes.inputM : classes.inputD,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, __jsx(InputLabel, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0430\\u0434\\u0440\\u0435\\u0441\"), __jsx(Input, {\n    value: newAddress,\n    onChange: function onChange(event) {\n      setNewAddress(event.target.value);\n    },\n    inputProps: {\n      'aria-label': 'description'\n    },\n    endAdornment: __jsx(InputAdornment, {\n      position: \"end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, __jsx(IconButton, {\n      onClick: function onClick() {\n        addAddress();\n      },\n      \"aria-label\": \"toggle password visibility\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, __jsx(Add, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }))),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  })), address ? address.map(function (element, idx) {\n    return __jsx(React.Fragment, null, __jsx(FormControl, {\n      key: idx,\n      className: isMobileApp ? classes.inputM : classes.inputD,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, __jsx(InputLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"\\u0410\\u0434\\u0440\\u0435\\u0441\"), __jsx(Input, {\n      placeholder: \"\\u0410\\u0434\\u0440\\u0435\\u0441\",\n      value: element[0],\n      className: isMobileApp ? classes.inputM : classes.inputD,\n      onChange: function onChange(event) {\n        editAddress(event, idx);\n      },\n      inputProps: {\n        'aria-label': 'description'\n      },\n      endAdornment: __jsx(InputAdornment, {\n        position: \"end\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, __jsx(IconButton, {\n        onClick: function onClick() {\n          deleteAddress(idx);\n        },\n        \"aria-label\": \"toggle password visibility\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, __jsx(Remove, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }))),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"geo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, address[1] ? 'Изменить геолокацию' : 'Задайте геолокацию'));\n  }) : null, __jsx(TextField, {\n    label: \"email\",\n    value: email,\n    className: isMobileApp ? classes.inputM : classes.inputD,\n    onChange: function onChange(event) {\n      setEmail(event.target.value);\n    },\n    inputProps: {\n      'aria-label': 'description'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), __jsx(TextField, {\n    label: \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\",\n    value: phone,\n    className: isMobileApp ? classes.inputM : classes.inputD,\n    onChange: function onChange(event) {\n      setPhone(event.target.value);\n    },\n    inputProps: {\n      'aria-label': 'description'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }), __jsx(TextField, {\n    multiline: true,\n    label: \"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F\",\n    value: info,\n    className: isMobileApp ? classes.inputM : classes.inputD,\n    onChange: function onChange(event) {\n      setInfo(event.target.value);\n    },\n    inputProps: {\n      'aria-label': 'description'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, __jsx(Button, {\n    onClick:\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var editElement, action;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              editElement = {\n                _id: data.client.user._id\n              };\n              if (image !== undefined) editElement.image = image;\n              if (name.length > 0 && name !== data.client.name) editElement.name = name;\n              if (address.length > 0 && address !== data.client.address) editElement.address = address;\n              if (email.length > 0 && email !== data.client.email) editElement.email = email;\n              if (phone.length > 0 && phone !== data.client.phone) editElement.phone = phone;\n              if (info.length > 0 && info !== data.client.info) editElement.info = info;\n              if (newPass.length > 0) editElement.newPass = newPass;\n              if (phone.length > 0) editElement.phone = phone;\n\n              action =\n              /*#__PURE__*/\n              function () {\n                var _ref2 = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee() {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return setClient(editElement);\n\n                        case 2:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function action() {\n                  return _ref2.apply(this, arguments);\n                };\n              }();\n\n              setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n                action: action,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 219\n                },\n                __self: this\n              }));\n              showMiniDialog(true);\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    })),\n    size: \"small\",\n    color: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"), profile.role === 'admin' ? __jsx(Button, {\n    onClick:\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      var action;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              action =\n              /*#__PURE__*/\n              function () {\n                var _ref4 = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee3() {\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          _context3.next = 2;\n                          return onoffClient([data.client._id]);\n\n                        case 2:\n                          setStatus(status === 'active' ? 'deactive' : 'active');\n\n                        case 3:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                }));\n\n                return function action() {\n                  return _ref4.apply(this, arguments);\n                };\n              }();\n\n              setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n                action: action,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 230\n                },\n                __self: this\n              }));\n              showMiniDialog(true);\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    })),\n    size: \"small\",\n    color: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, status === 'active' ? 'Отключить' : 'Включить') : __jsx(Button, {\n    onClick: function onClick() {\n      var action =\n      /*#__PURE__*/\n      function () {\n        var _ref5 = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee5() {\n          return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n            while (1) {\n              switch (_context5.prev = _context5.next) {\n                case 0:\n                  logout();\n\n                case 1:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n          }, _callee5);\n        }));\n\n        return function action() {\n          return _ref5.apply(this, arguments);\n        };\n      }();\n\n      setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n        action: action,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }));\n      showMiniDialog(true);\n    },\n    size: \"small\",\n    color: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, \"\\u0412\\u044B\\u0439\\u0442\\u0438\")))) : __jsx(React.Fragment, null, __jsx(LazyLoadImage, {\n    placeholderSrc: \"/static/add.png\",\n    effect: \"blur\",\n    className: classes.media,\n    src: preview,\n    alt: name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.name,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259\n    },\n    __self: this\n  }, name), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263\n    },\n    __self: this\n  }, \"\\u0410\\u0434\\u0440\\u0435\\u0441:\\xA0\"), __jsx(\"div\", {\n    className: classes.column,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266\n    },\n    __self: this\n  }, address ? address.map(function (element, idx) {\n    return __jsx(\"div\", {\n      className: classes.value,\n      key: idx,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, element);\n  }) : null)), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275\n    },\n    __self: this\n  }, \"E-mail:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278\n    },\n    __self: this\n  }, email)), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283\n    },\n    __self: this\n  }, \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286\n    },\n    __self: this\n  }, phone)), __jsx(\"div\", {\n    className: classes.info,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290\n    },\n    __self: this\n  }, info))) : 'Ничего не найдено')), __jsx(\"input\", {\n    accept: \"image/*\",\n    style: {\n      display: 'none'\n    },\n    id: \"contained-button-file\",\n    type: \"file\",\n    onChange: handleChangeImage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300\n    },\n    __self: this\n  }));\n});\n\nClient.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref6 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee6(ctx) {\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            if (!['организация', 'менеджер', 'admin', 'экспедитор', 'client'].includes(ctx.store.getState().user.profile.role)) if (ctx.res) {\n              ctx.res.writeHead(302, {\n                Location: '/'\n              });\n              ctx.res.end();\n            } else Router.push('/');\n            _context6.next = 3;\n            return getClient({\n              _id: ctx.query.id\n            });\n\n          case 3:\n            _context6.t0 = _context6.sent;\n            return _context6.abrupt(\"return\", {\n              data: _context6.t0\n            });\n\n          case 5:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n\n  return function (_x) {\n    return _ref6.apply(this, arguments);\n  };\n}();\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.user,\n    app: state.app\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch),\n    userActions: bindActionCreators(userActions, dispatch)\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Client);","map":{"version":3,"sources":["C:\\projects\\azyk\\azyk-admin\\pages\\client\\[id].js"],"names":["Head","React","useState","App","connect","getClient","clientStyle","Card","CardActions","Input","Button","bindActionCreators","mini_dialogActions","userActions","onoffClient","setClient","Add","Remove","IconButton","InputAdornment","Visibility","VisibilityOff","TextField","FormControl","InputLabel","LazyLoadImage","Router","Confirmation","Client","memo","props","profile","user","classes","data","isMobileApp","app","client","status","setStatus","name","setName","email","setEmail","phone","setPhone","address","map","addres","setAddress","newAddress","setNewAddress","addAddress","editAddress","event","idx","target","value","deleteAddress","splice","info","setInfo","image","preview","setPreview","undefined","setImage","handleChangeImage","files","URL","createObjectURL","setMiniDialog","showMiniDialog","logout","newPass","setNewPass","handleNewPass","hide","setHide","handleHide","filterSubCategory","sortSubCategory","page","column","row","justifyContent","alignItems","role","_id","media","inputM","inputD","element","editElement","length","action","nameField","display","getInitialProps","ctx","includes","store","getState","res","writeHead","Location","end","push","query","id","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import Head from 'next/head';\r\nimport React, { useState } from 'react';\r\nimport App from '../../layouts/App';\r\nimport { connect } from 'react-redux'\r\nimport { getClient } from '../../src/gql/client'\r\nimport clientStyle from '../../src/styleMUI/client/client'\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport Input from '@material-ui/core/Input';\r\nimport Button from '@material-ui/core/Button';\r\nimport { bindActionCreators } from 'redux'\r\nimport * as mini_dialogActions from '../../redux/actions/mini_dialog'\r\nimport * as userActions from '../../redux/actions/user'\r\nimport { onoffClient, setClient } from '../../src/gql/client'\r\nimport Add from '@material-ui/icons/Done';\r\nimport Remove from '@material-ui/icons/Delete';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\r\nimport Router from 'next/router'\r\nimport Confirmation from '../../components/dialog/Confirmation'\r\n\r\nconst Client = React.memo((props) => {\r\n    const { profile } = props.user;\r\n    const classes = clientStyle();\r\n    const { data } = props;\r\n    const { isMobileApp } = props.app;\r\n    let [status, setStatus] = useState(data.client!==null?data.client.user.status:'');\r\n    let [name, setName] = useState(data.client!==null?data.client.name:'');\r\n    let [email, setEmail] = useState(data.client!==null?data.client.email:'');\r\n    let [phone, setPhone] = useState(data.client!==null?data.client.user.phone:'');\r\n\r\n    //привести к геолокации\r\n    if(!Array.isArray(data.client.address[0])) data.client.address.map((addres)=>[addres])\r\n\r\n    let [address, setAddress] = useState(data.client!==null?data.client.address:[]);\r\n    let [newAddress, setNewAddress] = useState('');\r\n    let addAddress = ()=>{\r\n        address = [...address, [newAddress]]\r\n        setAddress(address)\r\n        setNewAddress('')\r\n    };\r\n    let editAddress = (event, idx)=>{\r\n        address[idx][0] = event.target.value\r\n        setAddress([...address])\r\n    };\r\n    let deleteAddress = (idx)=>{\r\n        address.splice(idx, 1);\r\n        setAddress([...address])\r\n    };\r\n\r\n    let [info, setInfo] = useState(data.client!==null?data.client.info:'');\r\n    let [preview, setPreview] = useState(data.client!==null?data.client.image:'');\r\n    let [image, setImage] = useState(undefined);\r\n    let handleChangeImage = ((event) => {\r\n        setImage(event.target.files[0])\r\n        setPreview(URL.createObjectURL(event.target.files[0]))\r\n    })\r\n    const { setMiniDialog, showMiniDialog } = props.mini_dialogActions;\r\n    const { logout } = props.userActions;\r\n    let [newPass, setNewPass] = useState('');\r\n    let handleNewPass =  (event) => {\r\n        setNewPass(event.target.value)\r\n    };\r\n    let [hide, setHide] = useState('password');\r\n    let handleHide =  () => {\r\n        setHide(!hide)\r\n    };\r\n    return (\r\n        <App filters={data.filterSubCategory} sorts={data.sortSubCategory} pageName={data.client!==null?data.client.name:'Ничего не найдено'}>\r\n            <Head>\r\n                <title>{data.client!==null?data.client.name:'Ничего не найдено'}</title>\r\n            </Head>\r\n            <Card className={classes.page}>\r\n                <CardActions className={isMobileApp?classes.column:classes.row} style={isMobileApp?{}:{justifyContent: 'start', alignItems: 'flex-start'}}>\r\n                    {data.client!==null?\r\n                            profile.role==='admin'||profile._id===data.client.user._id?\r\n                                <>\r\n                                <label htmlFor='contained-button-file'>\r\n                                    <LazyLoadImage\r\n                                        placeholderSrc='/static/add.png'\r\n                                        effect='blur'\r\n                                        className={classes.media}\r\n                                        src={preview}\r\n                                        alt={'Добавить'}\r\n                                    />\r\n                                </label>\r\n                                <div>\r\n                                        <TextField\r\n                                            label='Имя'\r\n                                            value={name}\r\n                                            className={isMobileApp?classes.inputM:classes.inputD}\r\n                                            onChange={(event)=>{setName(event.target.value)}}\r\n                                            inputProps={{\r\n                                                'aria-label': 'description',\r\n                                            }}\r\n                                        />\r\n                                        <Input\r\n                                            placeholder='Новый пароль'\r\n                                            type={hide ? 'password' : 'text' }\r\n                                            value={newPass}\r\n                                            onChange={handleNewPass}\r\n                                            className={isMobileApp?classes.inputM:classes.inputD}\r\n                                            endAdornment={\r\n                                                <InputAdornment position=\"end\">\r\n                                                    <IconButton aria-label=\"Toggle password visibility\" onClick={handleHide}>\r\n                                                        {hide ? <VisibilityOff />:<Visibility />  }\r\n                                                    </IconButton>\r\n                                                </InputAdornment>\r\n                                            }\r\n                                        />\r\n\r\n                                    <FormControl className={isMobileApp?classes.inputM:classes.inputD}>\r\n                                        <InputLabel>Добавить адрес</InputLabel>\r\n                                        <Input\r\n                                            value={newAddress}\r\n                                            onChange={(event)=>{setNewAddress(event.target.value)}}\r\n                                            inputProps={{\r\n                                                'aria-label': 'description',\r\n                                            }}\r\n                                            endAdornment={\r\n                                                <InputAdornment position=\"end\">\r\n                                                    <IconButton\r\n                                                        onClick={()=>{\r\n                                                            addAddress()\r\n                                                        }}\r\n                                                        aria-label='toggle password visibility'\r\n                                                    >\r\n                                                        <Add/>\r\n                                                    </IconButton>\r\n                                                </InputAdornment>\r\n                                            }\r\n                                    />\r\n                                    </FormControl>\r\n                                    {address?address.map((element, idx)=>\r\n                                        <>\r\n                                        <FormControl key={idx} className={isMobileApp?classes.inputM:classes.inputD}>\r\n                                            <InputLabel>Адрес</InputLabel>\r\n                                            <Input\r\n                                                placeholder='Адрес'\r\n                                                value={element[0]}\r\n                                                className={isMobileApp?classes.inputM:classes.inputD}\r\n                                                onChange={(event)=>{editAddress(event, idx)}}\r\n                                                inputProps={{\r\n                                                    'aria-label': 'description',\r\n                                                }}\r\n                                                endAdornment={\r\n                                                    <InputAdornment position=\"end\">\r\n                                                        <IconButton\r\n                                                            onClick={()=>{\r\n                                                                deleteAddress(idx)\r\n                                                            }}\r\n                                                            aria-label='toggle password visibility'\r\n                                                        >\r\n                                                            <Remove/>\r\n                                                        </IconButton>\r\n                                                    </InputAdornment>\r\n                                                }\r\n                                            />\r\n                                        </FormControl>\r\n                                        <div className='geo'>\r\n                                            {\r\n                                                address[1]?\r\n                                                    'Изменить геолокацию'\r\n                                                    :\r\n                                                    'Задайте геолокацию'\r\n                                            }\r\n                                        </div>\r\n                                        </>\r\n                                    ):null}\r\n\r\n                                    <TextField\r\n                                        label='email'\r\n                                        value={email}\r\n                                        className={isMobileApp?classes.inputM:classes.inputD}\r\n                                        onChange={(event)=>{setEmail(event.target.value)}}\r\n                                        inputProps={{\r\n                                            'aria-label': 'description',\r\n                                        }}\r\n                                    />\r\n                                    <TextField\r\n                                        label='Телефон'\r\n                                        value={phone}\r\n                                        className={isMobileApp?classes.inputM:classes.inputD}\r\n                                        onChange={(event)=>{setPhone(event.target.value)}}\r\n                                        inputProps={{\r\n                                            'aria-label': 'description',\r\n                                        }}\r\n                                    />\r\n                                    <TextField\r\n                                        multiline={true}\r\n                                        label='Информация'\r\n                                        value={info}\r\n                                        className={isMobileApp?classes.inputM:classes.inputD}\r\n                                        onChange={(event)=>{setInfo(event.target.value)}}\r\n                                        inputProps={{\r\n                                            'aria-label': 'description',\r\n                                        }}\r\n                                    />\r\n                                    <div className={classes.row}>\r\n                                        <Button onClick={async()=>{\r\n                                            let editElement = {_id: data.client.user._id}\r\n                                            if(image!==undefined)editElement.image = image\r\n                                            if(name.length>0&&name!==data.client.name)editElement.name = name\r\n                                            if(address.length>0&&address!==data.client.address)editElement.address = address\r\n                                            if(email.length>0&&email!==data.client.email)editElement.email = email\r\n                                            if(phone.length>0&&phone!==data.client.phone)editElement.phone = phone\r\n                                            if(info.length>0&&info!==data.client.info)editElement.info = info\r\n                                            if(newPass.length>0)editElement.newPass = newPass\r\n                                            if(phone.length>0)editElement.phone = phone\r\n                                            const action = async() => {\r\n                                                await setClient(editElement)\r\n                                            }\r\n                                            setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n                                            showMiniDialog(true)\r\n                                        }} size='small' color='primary'>\r\n                                            Сохранить\r\n                                        </Button>\r\n                                        {profile.role==='admin'?\r\n                                            <Button onClick={async()=>{\r\n                                                const action = async() => {\r\n                                                    await onoffClient([data.client._id])\r\n                                                    setStatus(status==='active'?'deactive':'active')\r\n                                                }\r\n                                                setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n                                                showMiniDialog(true)\r\n                                            }} size='small' color='primary'>\r\n                                                {status==='active'?'Отключить':'Включить'}\r\n                                            </Button>\r\n                                            :\r\n                                            <Button onClick={()=>{\r\n                                                const action = async() => {\r\n                                                    logout()\r\n                                                }\r\n                                                setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n                                                showMiniDialog(true)\r\n                                            }} size='small' color='primary'>\r\n                                                Выйти\r\n                                            </Button>\r\n                                        }\r\n                                    </div>\r\n                                </div>\r\n                                </>\r\n                                :\r\n                                <>\r\n                                <LazyLoadImage\r\n                                    placeholderSrc='/static/add.png'\r\n                                    effect='blur'\r\n                                    className={classes.media}\r\n                                    src={preview}\r\n                                    alt={name}\r\n                                />\r\n                                <div>\r\n                                    <div className={classes.name}>\r\n                                        {name}\r\n                                    </div>\r\n                                    <div className={classes.row}>\r\n                                        <div className={classes.nameField}>\r\n                                            Адрес:&nbsp;\r\n                                        </div>\r\n                                        <div className={classes.column}>\r\n                                            {address?address.map((element, idx)=>\r\n                                                <div className={classes.value} key={idx}>\r\n                                                    {element}\r\n                                                </div>\r\n                                            ):null}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className={classes.row}>\r\n                                        <div className={classes.nameField}>\r\n                                            E-mail:&nbsp;\r\n                                        </div>\r\n                                        <div className={classes.value}>\r\n                                            {email}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className={classes.row}>\r\n                                        <div className={classes.nameField}>\r\n                                            Телефон:&nbsp;\r\n                                        </div>\r\n                                        <div className={classes.value}>\r\n                                            {phone}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className={classes.info}>\r\n                                        {info}\r\n                                    </div>\r\n                                </div>\r\n                                </>\r\n                            :\r\n                            'Ничего не найдено'\r\n                            }\r\n                        </CardActions>\r\n                </Card>\r\n            <input\r\n                accept='image/*'\r\n                style={{ display: 'none' }}\r\n                id='contained-button-file'\r\n                type='file'\r\n                onChange={handleChangeImage}\r\n            />\r\n        </App>\r\n    )\r\n})\r\n\r\nClient.getInitialProps = async function(ctx) {\r\n    if(!['организация', 'менеджер', 'admin', 'экспедитор', 'client'].includes(ctx.store.getState().user.profile.role))\r\n        if(ctx.res) {\r\n            ctx.res.writeHead(302, {\r\n                Location: '/'\r\n            })\r\n            ctx.res.end()\r\n        } else\r\n            Router.push('/')\r\n    return {\r\n        data: await getClient({_id: ctx.query.id})\r\n    };\r\n};\r\n\r\nfunction mapStateToProps (state) {\r\n    return {\r\n        user: state.user,\r\n        app: state.app\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch),\r\n        userActions: bindActionCreators(userActions, dispatch),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Client);"]},"metadata":{},"sourceType":"module"}