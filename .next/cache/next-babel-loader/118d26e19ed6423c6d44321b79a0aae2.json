{"ast":null,"code":"var _jsxFileName = \"C:\\\\projects\\\\azyk\\\\azyk-admin\\\\components\\\\dialog\\\\Order.js\";\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { cancelOrders, approveOrders, setOrder, setInvoice } from '../../src/gql/order';\nimport * as mini_dialogActions from '../../redux/actions/mini_dialog';\nimport * as snackbarActions from '../../redux/actions/snackbar';\nimport * as userActions from '../../redux/actions/user';\nimport Button from '@material-ui/core/Button';\nimport dialogContentStyle from '../../src/styleMUI/dialogContent';\nimport { pdDDMMYYHHMM, pdDDMMYYHHMMCancel } from '../../src/lib';\nimport Confirmation from './Confirmation';\nimport Geo from '../../components/dialog/Geo';\nimport IconButton from '@material-ui/core/IconButton';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nconst Order = React.memo(props => {\n  const {\n    isMobileApp\n  } = props.app;\n  const {\n    profile\n  } = props.user;\n  const {\n    showMiniDialog,\n    setMiniDialog\n  } = props.mini_dialogActions;\n  const {\n    classes,\n    element,\n    setList,\n    route,\n    getInvoices\n  } = props;\n  let {\n    0: orders,\n    1: setOrders\n  } = useState(element.orders);\n  let {\n    0: allPrice,\n    1: setAllPrice\n  } = useState(element.allPrice);\n  let {\n    0: taken,\n    1: setTaken\n  } = useState(element.taken);\n  let {\n    0: confirmationForwarder,\n    1: setConfirmationForwarder\n  } = useState(element.confirmationForwarder);\n  let {\n    0: confirmationClient,\n    1: setConfirmationClient\n  } = useState(element.confirmationClient);\n  let {\n    0: cancelForwarder,\n    1: setCancelForwarder\n  } = useState(element.cancelForwarder != undefined && element.cancelForwarder);\n  let {\n    0: cancelClient,\n    1: setCancelClient\n  } = useState(element.cancelClient != undefined && element.cancelClient);\n  console.log(cancelForwarder, cancelClient);\n  const width = isMobileApp ? window.innerWidth - 144 : 500;\n  const {\n    showSnackBar\n  } = props.snackbarActions;\n\n  let canculateAllPrice = () => {\n    allPrice = 0;\n\n    for (let i = 0; i < orders.length; i++) {\n      allPrice += orders[i].allPrice;\n    }\n\n    if (element.usedBonus && element.usedBonus > 0) allPrice -= element.usedBonus;\n    setAllPrice(allPrice);\n  };\n\n  let increment = idx => {\n    orders[idx].count += 1;\n    orders[idx].allPrice = orders[idx].count * (orders[idx].item.stock === 0 || orders[idx].item.stock === undefined ? orders[idx].item.price : orders[idx].item.stock);\n    setOrders([...orders]);\n    canculateAllPrice();\n  };\n\n  let decrement = idx => {\n    if (orders[idx].count > 1) {\n      orders[idx].count -= 1;\n      orders[idx].allPrice = orders[idx].count * (orders[idx].item.stock === 0 || orders[idx].item.stock === undefined ? orders[idx].item.price : orders[idx].item.stock);\n      setOrders([...orders]);\n      canculateAllPrice();\n    }\n  };\n\n  let remove = idx => {\n    if (orders.length > 1) {\n      orders.splice(idx, 1);\n      setOrders([...orders]);\n      canculateAllPrice();\n    } else showSnackBar('Товары не могут отсутствовать в заказе');\n  };\n\n  return __jsx(\"div\", {\n    className: classes.column,\n    style: {\n      width: width\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, \"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u2116:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, element.number)), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, \"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, element.orders[0].status === 'принят' && (element.confirmationForwarder || element.confirmationClient) ? element.confirmationClient ? 'подтвержден клиентом' : element.confirmationForwarder ? 'доставлен поставщиком' : element.orders[0].status : element.orders[0].status)), element.agent && element.agent.name ? __jsx(\"a\", {\n    href: `/employment/${element.agent._id}`,\n    target: \"_blank\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, \"\\u0410\\u0433\\u0435\\u043D\\u0442: \\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, element.agent.name))) : null, __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \"\\u0410\\u0434\\u0440\\u0435\\u0441: \\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, element.address[0])), __jsx(\"div\", {\n    className: classes.geo,\n    style: {\n      color: element.address[1] ? '#ffb300' : 'red'\n    },\n    onClick: () => {\n      if (element.address[1]) {\n        setMiniDialog('Геолокация', __jsx(Geo, {\n          geo: element.address[1],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        }), true);\n        showMiniDialog(true);\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, element.address[1] ? 'Посмотреть геолокацию' : 'Геолокация не задана'), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, \"\\u0412\\u0440\\u0435\\u043C\\u044F \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430: \\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, pdDDMMYYHHMM(new Date(element.createdAt)))), element.dateDelivery ? __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"\\u0412\\u0440\\u0435\\u043C\\u044F \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, pdDDMMYYHHMM(new Date(element.dateDelivery)))) : null, __jsx(\"a\", {\n    href: `/client/${element.client._id}`,\n    target: \"_blank\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, \"\\u041F\\u043E\\u043B\\u0443\\u0447\\u0430\\u0442\\u0435\\u043B\\u044C:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, element.client.name))), __jsx(\"a\", {\n    href: `/organization/${element.orders[0].item.organization._id}`,\n    target: \"_blank\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"\\u041F\\u043E\\u0441\\u0442\\u0430\\u0432\\u0449\\u0438\\u043A:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, element.orders[0].item.organization.name))), element.usedBonus && element.usedBonus > 0 ? __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, \"\\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043D\\u043D\\u044B\\u0439 \\u0431\\u043E\\u043D\\u0443\\u0441:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, element.usedBonus, \"\\xA0\\u0441\\u043E\\u043C\")) : null, __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, \"\\u0421\\u0443\\u043C\\u043C\\u0430:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, allPrice, \"\\xA0\\u0441\\u043E\\u043C\")), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, \"\\u0421\\u043F\\u043E\\u0441\\u043E\\u0431 \\u043E\\u043F\\u043B\\u0430\\u0442\\u044B:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, element.paymentMethod)), __jsx(\"div\", {\n    className: classes.row,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.nameField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, \"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F:\\xA0\"), __jsx(\"div\", {\n    className: classes.value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, element.info)), __jsx(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: classes.column,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, __jsx(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, \"\\u0422\\u043E\\u0432\\u0430\\u0440\\u044B:\"), orders.map((order, idx) => {\n    if (element.orders[0].status === 'обработка' && (profile.role === 'client' || ['менеджер', 'организация'].includes(profile.role) || profile.role === 'admin')) return __jsx(\"div\", {\n      key: idx,\n      className: classes.column,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \"\\u0422\\u043E\\u0432\\u0430\\u0440:\\xA0\"), __jsx(\"a\", {\n      href: `/item/${order.item._id}`,\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, order.item.name)), __jsx(IconButton, {\n      onClick: () => {\n        remove(idx);\n      },\n      color: \"primary\",\n      className: classes.button,\n      \"aria-label\": \"\\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, __jsx(CancelIcon, {\n      style: {\n        height: 20,\n        width: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }))), __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E:\\xA0\"), __jsx(\"div\", {\n      className: classes.counterbtn,\n      onClick: () => {\n        decrement(idx);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"-\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, order.count, \"\\xA0\\u0448\\u0442\"), __jsx(\"div\", {\n      className: classes.counterbtn,\n      onClick: () => {\n        increment(idx);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, \"+\")), __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, \"\\u041E\\u0431\\u0449\\u0430\\u044F \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C:\\xA0\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, order.allPrice, \"\\xA0\\u0441\\u043E\\u043C\")), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }));else return __jsx(\"div\", {\n      key: idx,\n      className: classes.column,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, __jsx(\"a\", {\n      href: `/item/${order.item._id}`,\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, \"\\u0422\\u043E\\u0432\\u0430\\u0440:\\xA0\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, order.item.name))), __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E:\\xA0\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, order.count, \"\\xA0\\u0448\\u0442\")), __jsx(\"div\", {\n      className: classes.row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.nameField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"\\u041E\\u0431\\u0449\\u0430\\u044F \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C:\\xA0\"), __jsx(\"div\", {\n      className: classes.value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, order.allPrice, \"\\xA0\\u0441\\u043E\\u043C\")), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }));\n  })), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, __jsx(FormControlLabel, {\n    disabled: !['менеджер', 'организация', 'admin'].includes(profile.role) || !['обработка', 'принят'].includes(element.orders[0].status),\n    control: __jsx(Checkbox, {\n      checked: taken,\n      onChange: () => {\n        setTaken(!taken);\n      },\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }),\n    label: \"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u043F\\u0440\\u0438\\u043D\\u044F\\u0442\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239\n    },\n    __self: this\n  }, __jsx(FormControlLabel, {\n    disabled: !['менеджер', 'организация', 'admin', 'экспедитор'].includes(profile.role) || 'принят' !== element.orders[0].status,\n    control: __jsx(Checkbox, {\n      checked: confirmationForwarder,\n      onChange: () => {\n        setConfirmationForwarder(!confirmationForwarder);\n      },\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }),\n    label: \"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254\n    },\n    __self: this\n  }, __jsx(FormControlLabel, {\n    disabled: !['client', 'admin'].includes(profile.role) || 'принят' !== element.orders[0].status,\n    control: __jsx(Checkbox, {\n      checked: confirmationClient,\n      onChange: () => {\n        setConfirmationClient(!confirmationClient);\n      },\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }),\n    label: \"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }, __jsx(FormControlLabel, {\n    disabled: !['client', 'организация', 'менеджер', 'admin'].includes(profile.role) || !['отмена', 'обработка'].includes(element.orders[0].status),\n    control: __jsx(Checkbox, {\n      checked: element.cancelClient != undefined || element.cancelForwarder != undefined ? element.cancelClient != undefined ? cancelClient : cancelForwarder : 'client' === profile.role ? cancelClient : cancelForwarder,\n      onChange: () => {\n        if ('client' === profile.role) setCancelClient(!cancelClient);else if ('admin' === profile.role) {\n          if (element.cancelClient != undefined) setCancelClient(!cancelClient);else setCancelForwarder(!cancelForwarder);\n        } else setCancelForwarder(!cancelForwarder);\n      },\n      color: \"secondary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }),\n    label: element.cancelClient && element.cancelForwarder ? 'Заказ отменен' : `Востановить заказ до ${element.cancelClient ? pdDDMMYYHHMMCancel(new Date(element.cancelClient)) : pdDDMMYYHHMMCancel(new Date(element.cancelForwarder))}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354\n    },\n    __self: this\n  }, profile.role === 'client' || ['менеджер', 'организация'].includes(profile.role) || profile.role === 'admin' ? __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: () => {\n      const action = async () => {\n        let invoice = {\n          invoice: element._id\n        };\n        if (element.taken !== taken) invoice.taken = taken;\n        if (element.confirmationClient !== confirmationClient) invoice.confirmationClient = confirmationClient;\n        if (element.confirmationForwarder !== confirmationForwarder) invoice.confirmationForwarder = confirmationForwarder;\n        if (element.cancelClient !== cancelClient) invoice.cancelClient = cancelClient;\n        if (element.cancelForwarder !== cancelForwarder) invoice.cancelForwarder = cancelForwarder;\n        await setInvoice(invoice);\n        let sendOrders;\n        if (element.orders[0].status !== 'обработка') sendOrders = [];else sendOrders = orders.map(order => {\n          return {\n            _id: order._id,\n            count: order.count,\n            allPrice: order.allPrice,\n            status: order.status\n          };\n        });\n        let invoices = (await setOrder({\n          orders: sendOrders,\n          invoice: element._id\n        })).invoices;\n        if (setList) setList(invoices);\n        if (getInvoices) getInvoices();\n        showMiniDialog(false);\n      };\n\n      setMiniDialog('Вы уверенны?', __jsx(Confirmation, {\n        action: action,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      }));\n    },\n    className: classes.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357\n    },\n    __self: this\n  }, \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\") : null, __jsx(Button, {\n    variant: \"contained\",\n    color: \"secondary\",\n    onClick: () => {\n      showMiniDialog(false);\n    },\n    className: classes.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 386\n    },\n    __self: this\n  }, \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\")));\n});\n\nfunction mapStateToProps(state) {\n  return {\n    mini_dialog: state.mini_dialog,\n    user: state.user,\n    app: state.app\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch),\n    userActions: bindActionCreators(userActions, dispatch),\n    snackbarActions: bindActionCreators(snackbarActions, dispatch)\n  };\n}\n\nOrder.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(dialogContentStyle)(Order));","map":{"version":3,"sources":["C:\\projects\\azyk\\azyk-admin\\components\\dialog\\Order.js"],"names":["React","useState","PropTypes","withStyles","connect","bindActionCreators","cancelOrders","approveOrders","setOrder","setInvoice","mini_dialogActions","snackbarActions","userActions","Button","dialogContentStyle","pdDDMMYYHHMM","pdDDMMYYHHMMCancel","Confirmation","Geo","IconButton","CancelIcon","Checkbox","FormControlLabel","Order","memo","props","isMobileApp","app","profile","user","showMiniDialog","setMiniDialog","classes","element","setList","route","getInvoices","orders","setOrders","allPrice","setAllPrice","taken","setTaken","confirmationForwarder","setConfirmationForwarder","confirmationClient","setConfirmationClient","cancelForwarder","setCancelForwarder","undefined","cancelClient","setCancelClient","console","log","width","window","innerWidth","showSnackBar","canculateAllPrice","i","length","usedBonus","increment","idx","count","item","stock","price","decrement","remove","splice","column","row","nameField","value","number","status","agent","name","_id","address","geo","color","Date","createdAt","dateDelivery","client","organization","paymentMethod","info","map","order","role","includes","button","height","counterbtn","action","invoice","sendOrders","invoices","mapStateToProps","state","mini_dialog","mapDispatchToProps","dispatch","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { connect } from 'react-redux'\r\nimport { bindActionCreators } from 'redux'\r\nimport { cancelOrders, approveOrders, setOrder, setInvoice } from '../../src/gql/order'\r\nimport * as mini_dialogActions from '../../redux/actions/mini_dialog'\r\nimport * as snackbarActions from '../../redux/actions/snackbar'\r\nimport * as userActions from '../../redux/actions/user'\r\nimport Button from '@material-ui/core/Button';\r\nimport dialogContentStyle from '../../src/styleMUI/dialogContent'\r\nimport { pdDDMMYYHHMM, pdDDMMYYHHMMCancel } from '../../src/lib'\r\nimport Confirmation from './Confirmation'\r\nimport Geo from '../../components/dialog/Geo'\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\n\r\nconst Order =  React.memo(\r\n    (props) =>{\r\n        const { isMobileApp } = props.app;\r\n        const { profile } = props.user;\r\n        const { showMiniDialog, setMiniDialog } = props.mini_dialogActions;\r\n        const { classes, element, setList, route, getInvoices } = props;\r\n        let [orders, setOrders] = useState(element.orders);\r\n        let [allPrice, setAllPrice] = useState(element.allPrice);\r\n        let [taken, setTaken] = useState(element.taken);\r\n        let [confirmationForwarder, setConfirmationForwarder] = useState(element.confirmationForwarder);\r\n        let [confirmationClient, setConfirmationClient] = useState(element.confirmationClient);\r\n        let [cancelForwarder, setCancelForwarder] = useState(element.cancelForwarder!=undefined&&element.cancelForwarder);\r\n        let [cancelClient, setCancelClient] = useState(element.cancelClient!=undefined&&element.cancelClient);\r\n        console.log(cancelForwarder, cancelClient)\r\n        const width = isMobileApp? (window.innerWidth-144) : 500;\r\n        const { showSnackBar } = props.snackbarActions;\r\n        let canculateAllPrice = ()=>{\r\n            allPrice=0\r\n            for(let i=0; i<orders.length; i++){\r\n                allPrice+=orders[i].allPrice\r\n            }\r\n            if(element.usedBonus&&element.usedBonus>0)\r\n                allPrice -= element.usedBonus\r\n            setAllPrice(allPrice)\r\n        }\r\n        let increment = (idx)=>{\r\n            orders[idx].count+=1\r\n            orders[idx].allPrice = orders[idx].count * (orders[idx].item.stock===0||orders[idx].item.stock===undefined?orders[idx].item.price:orders[idx].item.stock)\r\n            setOrders([...orders])\r\n            canculateAllPrice()\r\n        }\r\n        let decrement = (idx)=>{\r\n            if(orders[idx].count>1) {\r\n                orders[idx].count -= 1\r\n                orders[idx].allPrice = orders[idx].count * (orders[idx].item.stock===0||orders[idx].item.stock===undefined?orders[idx].item.price:orders[idx].item.stock)\r\n                setOrders([...orders])\r\n                canculateAllPrice()\r\n            }\r\n        }\r\n        let remove = (idx)=>{\r\n            if(orders.length>1) {\r\n                orders.splice(idx, 1)\r\n                setOrders([...orders])\r\n                canculateAllPrice()\r\n            } else\r\n                showSnackBar('Товары не могут отсутствовать в заказе')\r\n        }\r\n        return (\r\n            <div className={classes.column} style={{width: width}}>\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Заказ №:&nbsp;</div>\r\n                    <div className={classes.value}>{element.number}</div>\r\n                </div>\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Статус:&nbsp;</div>\r\n                    <div className={classes.value}>{\r\n                            element.orders[0].status==='принят'&&(element.confirmationForwarder||element.confirmationClient)?\r\n                                element.confirmationClient?\r\n                                    'подтвержден клиентом'\r\n                                    :\r\n                                    element.confirmationForwarder?\r\n                                        'доставлен поставщиком'\r\n                                        :\r\n                                        element.orders[0].status\r\n                                :\r\n                                element.orders[0].status\r\n                    }</div>\r\n                </div>\r\n                {\r\n                    element.agent&&element.agent.name?\r\n                        <a href={`/employment/${element.agent._id}`} target='_blank'>\r\n                            <div className={classes.row}>\r\n                                <div className={classes.nameField}>Агент: &nbsp;</div>\r\n                                <div className={classes.value}>{element.agent.name}</div>\r\n                            </div>\r\n                        </a>\r\n                        :\r\n                        null\r\n                }\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Адрес: &nbsp;</div>\r\n                    <div className={classes.value}>{element.address[0]}</div>\r\n                </div>\r\n                <div className={classes.geo} style={{color: element.address[1]?'#ffb300':'red'}} onClick={()=>{\r\n                    if(element.address[1]) {\r\n                        setMiniDialog('Геолокация', <Geo geo={element.address[1]}/>, true)\r\n                        showMiniDialog(true)\r\n                    }\r\n                }}>\r\n                    {\r\n                        element.address[1]?\r\n                            'Посмотреть геолокацию'\r\n                            :\r\n                            'Геолокация не задана'\r\n                    }\r\n                </div>\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Время заказа: &nbsp;</div>\r\n                    <div className={classes.value}>{pdDDMMYYHHMM(new Date(element.createdAt))}</div>\r\n                </div>\r\n                {\r\n                    element.dateDelivery?\r\n                        <div className={classes.row}>\r\n                            <div className={classes.nameField}>Время доставки:&nbsp;</div>\r\n                            <div className={classes.value}>{pdDDMMYYHHMM(new Date(element.dateDelivery))}</div>\r\n                        </div>\r\n                        :\r\n                        null\r\n                }\r\n                <a href={`/client/${element.client._id}`} target='_blank'>\r\n                    <div className={classes.row}>\r\n                        <div className={classes.nameField}>Получатель:&nbsp;</div>\r\n                        <div className={classes.value}>{element.client.name}</div>\r\n                    </div>\r\n                </a>\r\n                <a href={`/organization/${element.orders[0].item.organization._id}`} target='_blank'>\r\n                    <div className={classes.row}>\r\n                        <div className={classes.nameField}>Поставщик:&nbsp;</div>\r\n                        <div className={classes.value}>{element.orders[0].item.organization.name}</div>\r\n                    </div>\r\n                </a>\r\n                {\r\n                    element.usedBonus&&element.usedBonus>0?\r\n                        <div className={classes.row}>\r\n                            <div className={classes.nameField}>Использованный бонус:&nbsp;</div>\r\n                            <div className={classes.value}>{element.usedBonus}&nbsp;сом</div>\r\n                        </div>\r\n                        :\r\n                        null\r\n                }\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Сумма:&nbsp;</div>\r\n                    <div className={classes.value}>{allPrice}&nbsp;сом</div>\r\n                </div>\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Способ оплаты:&nbsp;</div>\r\n                    <div className={classes.value}>{element.paymentMethod}</div>\r\n                </div>\r\n                <div className={classes.row}>\r\n                    <div className={classes.nameField}>Информация:&nbsp;</div>\r\n                    <div className={classes.value}>{element.info}</div>\r\n                </div>\r\n                <br/>\r\n                <div className={classes.column}>\r\n                    <b>Товары:</b>\r\n                    {\r\n                        orders.map((order, idx) => {\r\n                            if(\r\n                                element.orders[0].status==='обработка'&&\r\n                                (\r\n                                    profile.role==='client'||\r\n                                    ['менеджер', 'организация'].includes(profile.role)||\r\n                                    profile.role==='admin'\r\n                                )\r\n                            )\r\n                                return(\r\n                                    <div key={idx} className={classes.column}>\r\n                                        <div className={classes.row}>\r\n                                            <div className={classes.nameField}>Товар:&nbsp;</div>\r\n                                            <a href={`/item/${order.item._id}`} target='_blank'>\r\n                                                <div className={classes.value}>{order.item.name}</div>\r\n                                            </a>\r\n                                            <IconButton onClick={()=>{\r\n                                                remove(idx)\r\n                                            }} color='primary' className={classes.button} aria-label='удалить'>\r\n                                                <CancelIcon style={{height: 20, width: 20}}/>\r\n                                            </IconButton>\r\n                                        </div>\r\n                                        <div className={classes.row}>\r\n                                            <div className={classes.nameField}>Количество:&nbsp;</div>\r\n                                            <div className={classes.counterbtn} onClick={()=>{decrement(idx)}}>-</div>\r\n                                            <div className={classes.value}>{order.count}&nbsp;шт</div>\r\n                                            <div className={classes.counterbtn} onClick={()=>{increment(idx)}}>+</div>\r\n                                        </div>\r\n                                        <div className={classes.row}>\r\n                                            <div className={classes.nameField}>Общая стоимость:&nbsp;</div>\r\n                                            <div className={classes.value}>{order.allPrice}&nbsp;сом</div>\r\n                                        </div>\r\n                                        <br/>\r\n                                    </div>\r\n                                )\r\n                            else\r\n                                return(\r\n                                    <div key={idx} className={classes.column}>\r\n                                        <a href={`/item/${order.item._id}`} target='_blank'>\r\n                                            <div className={classes.row}>\r\n                                                <div className={classes.nameField}>Товар:&nbsp;</div>\r\n                                                <div className={classes.value}>{order.item.name}</div>\r\n                                            </div>\r\n                                        </a>\r\n                                        <div className={classes.row}>\r\n                                            <div className={classes.nameField}>Количество:&nbsp;</div>\r\n                                            <div className={classes.value}>{order.count}&nbsp;шт</div>\r\n                                        </div>\r\n                                        <div className={classes.row}>\r\n                                            <div className={classes.nameField}>Общая стоимость:&nbsp;</div>\r\n                                            <div className={classes.value}>{order.allPrice}&nbsp;сом</div>\r\n                                        </div>\r\n                                        <br/>\r\n                                    </div>\r\n                                )\r\n                        })\r\n                    }\r\n                </div>\r\n                <div>\r\n                    <FormControlLabel\r\n                        disabled={(!['менеджер', 'организация', 'admin'].includes(profile.role)||!['обработка','принят'].includes(element.orders[0].status))}\r\n                        control={\r\n                            <Checkbox\r\n                                checked={taken}\r\n                                onChange={()=>{\r\n                                    setTaken(!taken);\r\n                                }}\r\n                                color='primary'\r\n                            />\r\n                        }\r\n                        label='Заказ принят'\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <FormControlLabel\r\n                        disabled={(!['менеджер', 'организация', 'admin', 'экспедитор'].includes(profile.role)||'принят'!==element.orders[0].status)}\r\n                        control={\r\n                            <Checkbox\r\n                                checked={confirmationForwarder}\r\n                                onChange={()=>{\r\n                                    setConfirmationForwarder(!confirmationForwarder);\r\n                                }}\r\n                                color='primary'\r\n                            />\r\n                        }\r\n                        label='Заказ доставлен'\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <FormControlLabel\r\n                        disabled={(!['client', 'admin'].includes(profile.role)||'принят'!==element.orders[0].status)}\r\n                        control={\r\n                            <Checkbox\r\n                                checked={confirmationClient}\r\n                                onChange={()=>{\r\n                                    setConfirmationClient(!confirmationClient);\r\n                                }}\r\n                                color='primary'\r\n                            />\r\n                        }\r\n                        label='Заказ получен'\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <FormControlLabel\r\n                        disabled={(\r\n                            !['client', 'организация', 'менеджер', 'admin'].includes(profile.role)||!['отмена','обработка'].includes(element.orders[0].status)\r\n                        )}\r\n                        control={\r\n                            <Checkbox\r\n                                checked={\r\n                                    element.cancelClient!=undefined||element.cancelForwarder!=undefined?\r\n                                        element.cancelClient!=undefined?\r\n                                            cancelClient\r\n                                            :\r\n                                            cancelForwarder\r\n                                        :\r\n                                        'client'===profile.role?\r\n                                            cancelClient\r\n                                            :\r\n                                            cancelForwarder\r\n                                }\r\n                                onChange={()=>{\r\n                                    if('client'===profile.role) setCancelClient(!cancelClient);\r\n                                    else if('admin'===profile.role){\r\n                                        if(element.cancelClient!=undefined)\r\n                                            setCancelClient(!cancelClient)\r\n                                        else\r\n                                            setCancelForwarder(!cancelForwarder)\r\n                                    }\r\n                                    else setCancelForwarder(!cancelForwarder);\r\n                                }}\r\n                                color='secondary'\r\n                            />\r\n                        }\r\n                        label={\r\n                            element.cancelClient&&element.cancelForwarder?\r\n                                'Заказ отменен'\r\n                                :\r\n                                `Востановить заказ до ${element.cancelClient?pdDDMMYYHHMMCancel(new Date(element.cancelClient)):pdDDMMYYHHMMCancel(new Date(element.cancelForwarder))}`\r\n                        }\r\n                    />\r\n                </div>\r\n                {/*\r\n                    {\r\n                        (\r\n                            (profile.role==='client'&&'принят'===element.orders[0].status&&!element.confirmationClient)\r\n                            ||\r\n                            (['менеджер', 'организация'].includes(profile.role)&&'принят'===element.orders[0].status&&!element.confirmationForwarder)\r\n                            ||\r\n                            profile.role==='admin'\r\n                        )?\r\n                            <Button variant='contained' color='primary' onClick={()=>{\r\n                                const action = async() => {\r\n                                    let invoices = (await approveOrders({route: route, invoices: [element._id]})).invoices\r\n                                    if(setList)\r\n                                        setList(invoices)\r\n                                    if(getInvoices)\r\n                                        getInvoices()\r\n                                }\r\n                                setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n                            }} className={classes.button}>\r\n                                Заказ выполнен\r\n                            </Button>\r\n                            :\r\n                            null\r\n                    }\r\n                    {\r\n                        (profile.role==='client'&&element.orders[0].status==='обработка')\r\n                        ||(['менеджер', 'организация'].includes(profile.role)&&['обработка', 'принят'].includes(element.orders[0].status)&&!element.confirmationForwarder\r\n                        ||profile.role==='admin')?\r\n                            <Button variant='contained' color='primary' onClick={()=>{\r\n                                let _id = element.orders.map(order=>order._id)\r\n                                const action = async() => {\r\n                                    let invoices = (await cancelOrders({_id: _id, invoice: element._id})).invoices\r\n                                    if(setList)\r\n                                        setList(invoices)\r\n                                    if(getInvoices)\r\n                                        getInvoices()\r\n                                }\r\n                                setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n                            }} className={classes.button}>\r\n                                Отменить заказ\r\n                            </Button>\r\n                            :\r\n                            null\r\n                    }\r\n                    */}\r\n                    <div>\r\n                {\r\n                    ((profile.role==='client'||['менеджер', 'организация'].includes(profile.role)||profile.role==='admin'))?\r\n                        <Button variant='contained' color='primary' onClick={()=>{\r\n                            const action = async() => {\r\n\r\n                                let invoice = {invoice: element._id}\r\n                                if(element.taken!==taken)invoice.taken=taken\r\n                                if(element.confirmationClient!==confirmationClient)invoice.confirmationClient=confirmationClient\r\n                                if(element.confirmationForwarder!==confirmationForwarder)invoice.confirmationForwarder=confirmationForwarder\r\n                                if(element.cancelClient!==cancelClient)invoice.cancelClient=cancelClient\r\n                                if(element.cancelForwarder!==cancelForwarder)invoice.cancelForwarder=cancelForwarder\r\n                                await setInvoice(invoice)\r\n\r\n                                let sendOrders;\r\n                                if(element.orders[0].status!=='обработка') sendOrders = []\r\n                                else sendOrders = orders.map((order)=>{return {_id: order._id, count: order.count, allPrice: order.allPrice, status: order.status}})\r\n\r\n                                let invoices = (await setOrder({orders: sendOrders, invoice: element._id})).invoices\r\n                                if(setList)\r\n                                    setList(invoices)\r\n                                if(getInvoices)\r\n                                    getInvoices()\r\n                                showMiniDialog(false);\r\n                            }\r\n                            setMiniDialog('Вы уверенны?', <Confirmation action={action}/>)\r\n                        }} className={classes.button}>\r\n                            Сохранить\r\n                        </Button>\r\n                        :\r\n                        null\r\n                }\r\n                    <Button variant='contained' color='secondary' onClick={()=>{showMiniDialog(false);}} className={classes.button}>\r\n                        Закрыть\r\n                    </Button>\r\n                    </div>\r\n            </div>\r\n        );\r\n    }\r\n)\r\n\r\nfunction mapStateToProps (state) {\r\n    return {\r\n        mini_dialog: state.mini_dialog,\r\n        user: state.user,\r\n        app: state.app\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        mini_dialogActions: bindActionCreators(mini_dialogActions, dispatch),\r\n        userActions: bindActionCreators(userActions, dispatch),\r\n        snackbarActions: bindActionCreators(snackbarActions, dispatch),\r\n    }\r\n}\r\n\r\nOrder.propTypes = {\r\n    classes: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(dialogContentStyle)(Order));"]},"metadata":{},"sourceType":"module"}